(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[503],{6503:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return L}});var l=a(7437),n=a(2265),o=a(5725);let i={dots:[],width:0,height:0,settings:null,updateDots(e,t,a,l){this.dots=e,this.width=t,this.height=a,this.settings={...l}}};function r(e,t,a,l,n,o){switch(e.save(),0!==o&&(e.translate(t,a),e.rotate(o*Math.PI/180),e.translate(-t,-a)),e.beginPath(),n){case"square":e.rect(t-l/2,a-l/2,l,l),e.fill();break;case"line":e.lineWidth=l/2,e.moveTo(t-l/2,a),e.lineTo(t+l/2,a),e.stroke();break;case"cross":e.lineWidth=l/4,e.moveTo(t-l/2,a-l/2),e.lineTo(t+l/2,a+l/2),e.moveTo(t-l/2,a+l/2),e.lineTo(t+l/2,a-l/2),e.stroke();break;case"diamond":e.moveTo(t,a-l/2),e.lineTo(t+l/2,a),e.lineTo(t,a+l/2),e.lineTo(t-l/2,a),e.closePath(),e.fill();break;case"ellipse":e.ellipse(t,a,l/2,l/3,0,0,2*Math.PI),e.fill();break;case"triangle":e.moveTo(t,a-l/2),e.lineTo(t+l/2,a+l/2),e.lineTo(t-l/2,a+l/2),e.closePath(),e.fill();break;case"hexagon":let i=l/2;for(let l=0;l<6;l++){let n=Math.PI/3*l,o=t+i*Math.cos(n),r=a+i*Math.sin(n);0===l?e.moveTo(o,r):e.lineTo(o,r)}e.closePath(),e.fill();break;default:e.arc(t,a,l/2,0,2*Math.PI),e.fill()}e.restore()}var s=a(12);async function c(e,t){let a=new Uint8Array(await e.arrayBuffer()),l=[137,80,78,71,13,10,26,10];for(let e=0;e<8;e++)if(a[e]!==l[e])throw Error("Not a valid PNG file");let n=[];n.push(new Uint8Array(l));let o=8,i=d(a,8);for(let[e,l]of(n.push(a.slice(o,o+4+4+i+4)),o+=8+i+4,Object.entries(t))){let t=function(e,t){let a=h(e),l=h(t),n=new Uint8Array(a.length+1+l.length);n.set(a,0),n[a.length]=0,n.set(l,a.length+1);let o=n.length,i=new Uint8Array(4);m(i,0,o);let r=new Uint8Array([116,69,88,116]),s=new Uint8Array(4+n.length);s.set(r,0),s.set(n,4);let c=function(e){let t=4294967295;for(let a=0;a<e.length;a++)t=g[(t^e[a])&255]^t>>>8;return 4294967295^t}(s),d=new Uint8Array(4);m(d,0,c);let u=new Uint8Array(8+n.length+4);return u.set(i,0),u.set(r,4),u.set(n,8),u.set(d,8+n.length),u}(e,l);n.push(t)}for(;o<a.length;){let e=d(a,o);if("IEND"===String.fromCharCode(a[o+4],a[o+5],a[o+6],a[o+7])){n.push(a.slice(o,o+4+4+e+4));break}n.push(a.slice(o,o+4+4+e+4)),o+=8+e+4}let r=new Uint8Array(n.reduce((e,t)=>e+t.length,0)),s=0;for(let e of n)r.set(e,s),s+=e.length;return new Blob([r],{type:"image/png"})}function h(e){let t=new Uint8Array(e.length);for(let a=0;a<e.length;a++)t[a]=e.charCodeAt(a);return t}function d(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]}function m(e,t,a){e[t]=a>>24&255,e[t+1]=a>>16&255,e[t+2]=a>>8&255,e[t+3]=255&a}let g=(()=>{let e=Array(256);for(let t=0;t<256;t++){let a=t;for(let e=0;e<8;e++)1&a?a=3988292384^a>>>1:a>>>=1;e[t]=a}return e})();var u=a(5601),f=a.n(u);let b={dots:[],width:0,height:0,settings:null,updateDots(e,t,a,l){this.dots=[...e],this.width=t,this.height=a,this.settings={...l}}},x={"floyd-steinberg":{matrix:[[0,0,7/16],[3/16,5/16,1/16]],width:3,height:2},jarvis:{matrix:[[0,0,0,7/48,5/48],[3/48,5/48,7/48,5/48,3/48],[1/48,3/48,5/48,3/48,1/48]],width:5,height:3},"judice-ninke":{matrix:[[0,0,0,7/48,5/48],[3/48,5/48,7/48,5/48,3/48],[1/48,3/48,5/48,3/48,1/48]],width:5,height:3},stucki:{matrix:[[0,0,0,8/42,4/42],[2/42,4/42,8/42,4/42,2/42],[1/42,2/42,4/42,2/42,1/42]],width:5,height:3},burkes:{matrix:[[0,0,0,.25,4/32],[2/32,4/32,.25,4/32,2/32]],width:5,height:2}};function p(e,t){let{data:a,width:l,height:n}=e,o=[];for(let e=0;e<a.length;e+=4)(a[e]>0||a[e+1]>0||a[e+2]>0)&&o.push([a[e],a[e+1],a[e+2]]);if(0===o.length)return[[0,0,0]];let i=[];for(let e=0;e<t;e++){let e=Math.floor(Math.random()*o.length);i.push([...o[e]])}for(let e=0;e<10;e++){let e=Array(t).fill(0).map(()=>[]);for(let t of o){let a=1/0,l=0;for(let e=0;e<i.length;e++){let n=Math.sqrt(Math.pow(t[0]-i[e][0],2)+Math.pow(t[1]-i[e][1],2)+Math.pow(t[2]-i[e][2],2));n<a&&(a=n,l=e)}e[l].push(t)}let a=!1;for(let t=0;t<i.length;t++){if(0===e[t].length)continue;let l=[0,0,0];for(let a of e[t])l[0]+=a[0],l[1]+=a[1],l[2]+=a[2];l[0]=Math.round(l[0]/e[t].length),l[1]=Math.round(l[1]/e[t].length),l[2]=Math.round(l[2]/e[t].length),(l[0]!==i[t][0]||l[1]!==i[t][1]||l[2]!==i[t][2])&&(a=!0),i[t]=l}if(!a)break}return i}function v(e){let t=parseInt(e.slice(1,3),16),a=parseInt(e.slice(3,5),16),l=parseInt(e.slice(5,7),16);return void 0!==t&&void 0!==a&&void 0!==l?[t,a,l]:void 0}function M(e,t){if(!t||0===Object.keys(t).length)return e;let a=e.lastIndexOf("</svg>");if(-1===a)return e;let l='  <metadata>\n    <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:rdfs="http://www.w3.org/2000/01/rdf-schema#" xmlns:dc="http://purl.org/dc/elements/1.1/">\n      <rdf:Description>\n';for(let[e,a]of Object.entries(t)){let t=a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;");l+="        <dc:".concat(e,">").concat(t,"</dc:").concat(e,">\n")}for(let e of(l+="        <dc:creator>ImageTweaker</dc:creator>\n        <dc:description>Halftone image created with ImageTweaker</dc:description>\n        <dc:halftoneSettings>\n",["cellSize","dotScale","shape","pattern","sizeVariation","invertBrightness","colored","spiralTightness","spiralExpansion","spiralRotation","spiralCenterX","spiralCenterY","concentricRingSpacing","concentricCenterX","concentricCenterY"]))t[e]&&(l+="          <dc:".concat(e,">").concat(t[e],"</dc:").concat(e,">\n"));return l+="        </dc:halftoneSettings>\n      </rdf:Description>\n    </rdf:RDF>\n  </metadata>\n",e.slice(0,a)+l+e.slice(a)}function j(e){if(!e)return;let t=new Date().toISOString().replace(/[:.]/g,"-").slice(0,19),a="imagetweaker-".concat(t,".png");try{e.toBlob(async e=>{if(e)try{let t=await c(e,{Software:"ImageTweaker v0.2.0",Author:"ImageTweaker realized by andreaperato.com",Website:"https://image-tweaker.vercel.app/"});(0,s.saveAs)(t,a)}catch(t){(0,s.saveAs)(e,a)}},"image/png")}catch(e){}}function y(e){if(!e)return;let t=new Date().toISOString().replace(/[:.]/g,"-").slice(0,19),a="imagetweaker-".concat(t,".svg");if(function(){let e=i.dots&&i.dots.length>0,t=b&&b.dots&&b.dots.length>0;return e||t}())try{e.width,e.height;let t={Software:"ImageTweaker v0.2.0",Author:"ImageTweaker realized by andreaperato.com",Website:"https://image-tweaker.vercel.app/",Date:new Date().toISOString()},l=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=e.width,l=e.height,n=e.getContext("2d");if(!n)throw Error("Cannot get canvas context");let o=n.getImageData(0,0,a,l);if(i.dots.length>0&&i.settings)try{return function(e,t,a,l){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},{shape:o}=l,r='<?xml version="1.0" encoding="UTF-8" standalone="no"?>\n<svg xmlns="http://www.w3.org/2000/svg" width="'.concat(t,'" height="').concat(a,'" viewBox="0 0 ').concat(t," ").concat(a,'">\n'),s="true"===n.backgroundEnabled,c=n.backgroundType||"white";function h(e,t,a,l,n,o){if(isNaN(e)||isNaN(t)||isNaN(a)||a<=0)return"";let i=o?' fill="'.concat(o,'"'):"";try{switch(l){case"circle":default:return'    <circle cx="'.concat(e,'" cy="').concat(t,'" r="').concat(a/2,'"').concat(i," />\n");case"square":return'    <rect x="'.concat(e-a/2,'" y="').concat(t-a/2,'" width="').concat(a,'" height="').concat(a,'" transform="rotate(').concat(n," ").concat(e," ").concat(t,')"').concat(i," />\n");case"diamond":return'    <rect x="'.concat(e-a/2,'" y="').concat(t-a/2,'" width="').concat(a,'" height="').concat(a,'" transform="rotate(45 ').concat(e," ").concat(t,')"').concat(i," />\n");case"line":return'    <line x1="'.concat(e-a/2,'" y1="').concat(t,'" x2="').concat(e+a/2,'" y2="').concat(t,'" stroke-width="').concat(a/4,'" stroke="currentColor" transform="rotate(').concat(n," ").concat(e," ").concat(t,')"').concat(i," />\n");case"cross":return'    <path d="M '.concat(e-a/2," ").concat(t," L ").concat(e+a/2," ").concat(t," M ").concat(e," ").concat(t-a/2," L ").concat(e," ").concat(t+a/2,'" stroke-width="').concat(a/4,'" stroke="currentColor" transform="rotate(').concat(n," ").concat(e," ").concat(t,')"').concat(i," />\n");case"ellipse":return'    <ellipse cx="'.concat(e,'" cy="').concat(t,'" rx="').concat(a/2,'" ry="').concat(a/4,'" transform="rotate(').concat(n," ").concat(e," ").concat(t,')"').concat(i," />\n");case"triangle":let o=a*Math.sqrt(3)/2;return'    <polygon points="'.concat(e,",").concat(t-a/2," ").concat(e-a/2,",").concat(t+o/2," ").concat(e+a/2,",").concat(t+o/2,'" transform="rotate(').concat(n," ").concat(e," ").concat(t,')"').concat(i," />\n");case"hexagon":return'    <polygon points="'.concat(e+a/2,",").concat(t," ").concat(e+a/4,",").concat(t+.433*a," ").concat(e-a/4,",").concat(t+.433*a," ").concat(e-a/2,",").concat(t," ").concat(e-a/4,",").concat(t-.433*a," ").concat(e+a/4,",").concat(t-.433*a,'" transform="rotate(').concat(n," ").concat(e," ").concat(t,')"').concat(i," />\n")}}catch(l){return'    <circle cx="'.concat(e,'" cy="').concat(t,'" r="').concat(a/2,'"').concat(i," />\n")}}function d(e,n,o,i,r,s){let c=e,h=n;try{if("hexagonal"===s&&i%2==0)c+=r/2;else if("spiral"===s){let o=t/2+(l.spiralCenterX||0),i=a/2+(l.spiralCenterY||0),s=e-o,d=n-i,m=Math.sqrt(s*s+d*d),g=(l.spiralRotation||0)*(Math.PI/180),u=l.spiralExpansion||1,f=Math.atan2(d,s)+g+m*(l.spiralTightness||.1)*u/r;c=o+Math.cos(f)*m,h=i+Math.sin(f)*m}else if("concentric"===s){let o=t/2+(l.concentricCenterX||0),i=a/2+(l.concentricCenterY||0),s=e-o,d=n-i,m=Math.atan2(d,s),g=r*(l.concentricRingSpacing||1),u=Math.floor(Math.sqrt(s*s+d*d)/g)*g;c=o+Math.cos(m)*u,h=i+Math.sin(m)*u}else if("random"===s){let e=(1e4*o+i)/(t*a);c+=(.5*Math.sin(e)+.5-.5)*r/2,h+=(Math.cos(e)-.5)*r/2}}catch(t){return{x:e,y:n}}return{x:c,y:h}}function m(n,i,r,s,c){let m="",g=(e,t)=>.5*Math.sin((9999*e+9973*t)%1e4)+.5,u=(e,t,a)=>{let l=1-Math.max(e/=255,t/=255,a/=255);return{c:1===l?0:(1-e-l)/(1-l),m:1===l?0:(1-t-l)/(1-l),y:1===l?0:(1-a-l)/(1-l),k:l}},f=Math.ceil(t/r),b=Math.ceil(a/r),x=[];for(let i=0;i<b;i++)for(let h=0;h<f;h++)try{let m=Math.floor(h*r+r/2),f=Math.floor(i*r+r/2),b=d(m,f,h,i,r,l.arrangement),p=b.x,v=b.y,M=Math.min(t-1,Math.max(0,Math.floor(p))),j=(Math.min(a-1,Math.max(0,Math.floor(v)))*t+M)*4,y=e.data[j],w=e.data[j+1],C=e.data[j+2],k=u(y,w,C)[n];c&&(k=1-k),k=Math.pow(k,1.35);let N=g(h,i),S=1+(N-.5)*l.sizeVariation,I={circle:1,square:.85,diamond:.85,line:1,cross:1,ellipse:1,triangle:.92,hexagon:.9},z=s*(I[o]||1),D=r*z*S*k;if(D<.5)continue;x.push({x:p,y:v,size:D})}catch(e){continue}for(let e of(x.sort((e,t)=>t.size-e.size),x))m+=h(e.x,e.y,e.size,o,i);return m}s&&"transparent"===c||(r+='  <rect width="'.concat(t,'" height="').concat(a,'" fill="white" />\n'));try{if(i.dots.length>0&&i.width===t&&i.height===a){if(l.enableCMYK&&(l.channels.cyan||l.channels.magenta||l.channels.yellow||l.channels.black)){let e=i.dots.filter(e=>"cyan"===e.color),t=i.dots.filter(e=>"magenta"===e.color),a=i.dots.filter(e=>"yellow"===e.color),n=i.dots.filter(e=>"black"===e.color);if(e.length>0&&l.channels.cyan){for(let t of(r+='  <g id="cyan-channel" fill="cyan" opacity="0.8">\n',e))r+=h(t.x,t.y,t.size,o,l.cmykAngles.cyan);r+="  </g>\n"}if(t.length>0&&l.channels.magenta){for(let e of(r+='  <g id="magenta-channel" fill="magenta" opacity="0.8">\n',t))r+=h(e.x,e.y,e.size,o,l.cmykAngles.magenta);r+="  </g>\n"}if(a.length>0&&l.channels.yellow){for(let e of(r+='  <g id="yellow-channel" fill="yellow" opacity="0.8">\n',a))r+=h(e.x,e.y,e.size,o,l.cmykAngles.yellow);r+="  </g>\n"}if(n.length>0&&l.channels.black){for(let e of(r+='  <g id="black-channel" fill="black" opacity="0.9">\n',n))r+=h(e.x,e.y,e.size,o,l.cmykAngles.black);r+="  </g>\n"}}else{let e=l.colored?"currentColor":"black";for(let t of(r+='  <g id="halftone-dots" fill="'.concat(e,'">\n'),[...i.dots].sort((e,t)=>t.size-e.size)))t.color&&l.colored?r+=h(t.x,t.y,t.size,o,0,t.color):r+=h(t.x,t.y,t.size,o,0);r+="  </g>\n"}}else{let{cellSize:n,dotScaleFactor:i,arrangement:s,spiralTightness:c,enableCMYK:g,channels:u,cmykAngles:f,invertBrightness:b}=l,x=Math.ceil(t/n),p=Math.ceil(a/n),v=i*(({circle:1,square:.85,diamond:.85,line:1,cross:1,ellipse:1,triangle:.92,hexagon:.9})[o]||1);if(g&&(u.cyan||u.magenta||u.yellow||u.black))u.cyan&&(r+='  <g id="cyan-channel" fill="cyan" opacity="0.8">\n'+m("c",f.cyan,n,v,b)+"  </g>\n"),u.magenta&&(r+='  <g id="magenta-channel" fill="magenta" opacity="0.8">\n'+m("m",f.magenta,n,v,b)+"  </g>\n"),u.yellow&&(r+='  <g id="yellow-channel" fill="yellow" opacity="0.8">\n'+m("y",f.yellow,n,v,b)+"  </g>\n"),u.black&&(r+='  <g id="black-channel" fill="black" opacity="0.9">\n'+m("k",f.black,n,v,b)+"  </g>\n");else{let i=l.colored?"currentColor":"black";r+='  <g id="halftone-dots" fill="'.concat(i,'">\n');let c=(e,t)=>.5*Math.sin((9999*e+9973*t)%1e4)+.5,m=[];for(let o=0;o<p;o++)for(let i=0;i<x;i++){let r=Math.floor(i*n+n/2),h=Math.floor(o*n+n/2),g=d(r,h,i,o,n,s),u=g.x,f=g.y,x=Math.min(t-1,Math.max(0,Math.floor(u))),p=(Math.min(a-1,Math.max(0,Math.floor(f)))*t+x)*4,M=e.data[p],j=e.data[p+1],y=e.data[p+2],w=(.299*M+.587*j+.114*y)/255;b||(w=1-w),w=Math.pow(w,1.35);let C=c(i,o),k=1+(C-.5)*l.sizeVariation,N=n*v*k*w;N<.5||(l.colored?m.push({x:u,y:f,size:N,color:"rgb(".concat(M,",").concat(j,",").concat(y,")")}):m.push({x:u,y:f,size:N}))}for(let e of(m.sort((e,t)=>t.size-e.size),m))e.color?r+=h(e.x,e.y,e.size,o,0,e.color):r+=h(e.x,e.y,e.size,o,0);r+="  </g>\n"}}}catch(e){return'<?xml version="1.0" encoding="UTF-8" standalone="no"?>\n<svg xmlns="http://www.w3.org/2000/svg" width="'.concat(t,'" height="').concat(a,'" viewBox="0 0 ').concat(t," ").concat(a,'">\n  <rect width="').concat(t,'" height="').concat(a,'" fill="white" />\n  <text x="10" y="20" fill="red">Error generating SVG</text>\n</svg>')}return M(r+="</svg>",n)}(o,a,l,i.settings,t)}catch(e){}if(b.dots.length>0&&b.settings)try{return function(e,t,a,l){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},o='<?xml version="1.0" encoding="UTF-8" standalone="no"?>\n<svg xmlns="http://www.w3.org/2000/svg" width="'.concat(t,'" height="').concat(a,'" viewBox="0 0 ').concat(t," ").concat(a,'">\n'),i="true"===n.backgroundEnabled,r=n.backgroundType||"white";i&&"transparent"===r||(o+='  <rect width="'.concat(t,'" height="').concat(a,'" fill="white" />\n'));let{dots:s}=b;if(!s||0===s.length)throw Error("No dither dots available for SVG export");let c={};s.forEach(e=>{let t=e.color||"black";c[t]||(c[t]=[]),c[t].push({x:e.x,y:e.y,size:e.size})}),Object.entries(c).forEach(e=>{let[t,a]=e;o+='  <g fill="'.concat(t,'">\n'),a.forEach(e=>{o+='    <rect x="'.concat(e.x,'" y="').concat(e.y,'" width="').concat(e.size,'" height="').concat(e.size,'" />\n')}),o+="  </g>\n"});let h={...n,ditherType:l.type||"ordered",colorMode:l.colorMode||"grayscale",threshold:String(l.threshold||128),resolution:String(l.resolution||100),colorDepth:String(l.colorDepth||2)};return"2-color"===l.colorMode&&(h.darkColor=l.darkColor||"#000000",h.lightColor=l.lightColor||"#FFFFFF"),M(o+="</svg>",h)}(o,a,l,b.settings,t)}catch(e){}return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=e.width,l=e.height,n=new(f())(a,l);return n.drawImage(e,0,0),M(n.getSerializedSvg(!0),t)}(e,t)}(e,t),n=new Blob([l],{type:"image/svg+xml;charset=utf-8"});(0,s.saveAs)(n,a);return}catch(e){}let l=e.width,n=e.height,o=e.toDataURL("image/png"),r='<?xml version="1.0" encoding="UTF-8" standalone="no"?>\n<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'.concat(l,'" height="').concat(n,'" viewBox="0 0 ').concat(l," ").concat(n,'">\n  <image width="').concat(l,'" height="').concat(n,'" xlink:href="').concat(o,'" />\n  <metadata>\n    <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"\n             xmlns:rdfs="http://www.w3.org/2000/01/rdf-schema#"\n             xmlns:dc="http://purl.org/dc/elements/1.1/">\n      <rdf:Description>\n        <dc:title>ImageTweaker Export</dc:title>\n        <dc:creator>ImageTweaker realized by andreaperato.com</dc:creator>\n        <dc:source>https://image-tweaker.vercel.app/</dc:source>\n        <dc:date>').concat(new Date().toISOString(),"</dc:date>\n      </rdf:Description>\n    </rdf:RDF>\n  </metadata>\n</svg>");try{let e=new Blob([r],{type:"image/svg+xml;charset=utf-8"});(0,s.saveAs)(e,a)}catch(e){}}function w(e){let t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:{r:0,g:0,b:0}}function C(e,t,a){let l=w(e),n=w(t),o=Math.round(l.r+(n.r-l.r)*a),i=Math.round(l.g+(n.g-l.g)*a),r=Math.round(l.b+(n.b-l.b)*a);return"#".concat(o.toString(16).padStart(2,"0")).concat(i.toString(16).padStart(2,"0")).concat(r.toString(16).padStart(2,"0"))}function k(e){let{imageUrl:t,modifiedImageUrl:a,onCropComplete:o,onCancel:i}=e,[r,s]=(0,n.useState)("free"),[c,h]=(0,n.useState)({x:0,y:0,width:0,height:0}),[d,m]=(0,n.useState)(!1),[g,u]=(0,n.useState)(!1),[f,b]=(0,n.useState)(null),[x,p]=(0,n.useState)({x:0,y:0}),[v,M]=(0,n.useState)({width:0,height:0}),j=(0,n.useRef)(null);(0,n.useRef)(null);let y=(0,n.useRef)(null),w=(0,n.useRef)(null);(0,n.useEffect)(()=>{let e=new Image;e.src=a,e.onload=()=>{if(w.current){let t=w.current,a=t.getContext("2d");t.width=e.width,t.height=e.height,a&&(a.clearRect(0,0,t.width,t.height),a.drawImage(e,0,0))}M({width:e.width,height:e.height}),h({x:0,y:0,width:e.width,height:e.height})}},[a]);let C=e=>{if("free"===e)return null;let[t,a]=e.split(":").map(Number);return t/a},k=e=>{let t={...c,...e},a=C(r);null!==a&&(void 0!==e.width?t.height=e.width/a:void 0!==e.height&&(t.width=e.height*a)),t.x=Math.max(0,Math.min(t.x,v.width-t.width)),t.y=Math.max(0,Math.min(t.y,v.height-t.height)),t.width=Math.min(t.width,v.width-t.x),t.height=Math.min(t.height,v.height-t.y),h(t)},N=(e,t,a)=>{e.stopPropagation(),m("drag"===t),u("resize"===t),b(a||null),p({x:e.clientX,y:e.clientY})},S=e=>{if(!d&&!g)return;let t=e.clientX-x.x,a=e.clientY-x.y;if(d)k({x:c.x+t,y:c.y+a});else if(g&&f){let e={};switch(f){case"top-left":e={x:c.x+t,y:c.y+a,width:c.width-t,height:c.height-a};break;case"top-right":e={y:c.y+a,width:c.width+t,height:c.height-a};break;case"bottom-left":e={x:c.x+t,width:c.width-t,height:c.height+a};break;case"bottom-right":e={width:c.width+t,height:c.height+a}}k(e)}p({x:e.clientX,y:e.clientY})},I=()=>{m(!1),u(!1),b(null)};return(0,n.useEffect)(()=>{let e=e=>{(d||g)&&S(e)},t=()=>{(d||g)&&I()};return window.addEventListener("mousemove",e),window.addEventListener("mouseup",t),()=>{window.removeEventListener("mousemove",e),window.removeEventListener("mouseup",t)}},[d,g,c,x,f]),(0,n.useEffect)(()=>{let e,t;if(0===v.width||0===v.height)return;let a=C(r);if(null===a)return;let l=c.x+c.width/2,n=c.y+c.height/2;c.width/c.height>a?e=(t=c.height)*a:t=(e=c.width)/a,h({x:Math.max(0,Math.min(l-e/2,v.width-e)),y:Math.max(0,Math.min(n-t/2,v.height-t)),width:e,height:t})},[r,v]),(0,l.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50",children:(0,l.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow-xl max-w-4xl w-full",children:[(0,l.jsxs)("div",{className:"mb-4 flex justify-between items-center",children:[(0,l.jsx)("h2",{className:"text-xl font-bold font-mono uppercase",children:"Crop Image"}),(0,l.jsxs)("div",{className:"space-x-2",children:[(0,l.jsx)("button",{onClick:i,className:"px-4 py-2 bg-gray-200 rounded hover:bg-gray-300 font-mono text-sm",children:"Cancel"}),(0,l.jsx)("button",{onClick:()=>{let e=document.createElement("canvas"),l=document.createElement("canvas"),n=e.getContext("2d"),i=l.getContext("2d");if(!n||!i||!w.current)return;e.width=c.width,e.height=c.height,l.width=c.width,l.height=c.height;let r=new Image,s=new Image;r.onload=()=>{n.drawImage(r,c.x,c.y,c.width,c.height,0,0,c.width,c.height),s.onload=()=>{i.drawImage(s,c.x,c.y,c.width,c.height,0,0,c.width,c.height),o(e.toDataURL(),l.toDataURL())},s.src=a},r.src=t},className:"px-4 py-2 bg-black text-white rounded hover:bg-gray-800 font-mono text-sm",children:"Apply Crop"})]})]}),(0,l.jsx)("div",{className:"mb-4 flex flex-wrap gap-2",children:["free","1:1","4:3","16:9","3:2","5:4","2:1","3:4","9:16","2:3","4:5","1:2"].map(e=>(0,l.jsx)("button",{onClick:()=>{s(e);let t=document.activeElement;t&&(t.classList.add("scale-95"),setTimeout(()=>t.classList.remove("scale-95"),150))},className:"px-3 py-1 rounded font-mono text-sm transition-all ".concat(r===e?"bg-black text-white shadow-md":"bg-gray-200 hover:bg-gray-300"),children:e},e))}),(0,l.jsxs)("div",{ref:j,className:"relative overflow-hidden border-2 border-gray-300",style:{maxHeight:"calc(80vh - 200px)",maxWidth:"100%",margin:"0 auto",aspectRatio:"".concat(v.width,"/").concat(v.height)},children:[(0,l.jsx)("canvas",{ref:w,className:"max-w-full max-h-full w-auto h-auto",style:{display:"block",width:"100%",height:"100%",objectFit:"contain"}}),(0,l.jsxs)("div",{ref:y,className:"absolute border-2 border-white shadow-lg",style:{left:"".concat(c.x/v.width*100,"%"),top:"".concat(c.y/v.height*100,"%"),width:"".concat(c.width/v.width*100,"%"),height:"".concat(c.height/v.height*100,"%"),cursor:d?"grabbing":"grab",boxShadow:"0 0 0 9999px rgba(0, 0, 0, 0.5)"},onMouseDown:e=>N(e,"drag"),children:[(0,l.jsx)("div",{className:"absolute w-4 h-4 bg-white cursor-nw-resize",style:{left:"-8px",top:"-8px"},onMouseDown:e=>N(e,"resize","top-left")}),(0,l.jsx)("div",{className:"absolute w-4 h-4 bg-white cursor-ne-resize",style:{right:"-8px",top:"-8px"},onMouseDown:e=>N(e,"resize","top-right")}),(0,l.jsx)("div",{className:"absolute w-4 h-4 bg-white cursor-sw-resize",style:{left:"-8px",bottom:"-8px"},onMouseDown:e=>N(e,"resize","bottom-left")}),(0,l.jsx)("div",{className:"absolute w-4 h-4 bg-white cursor-se-resize",style:{right:"-8px",bottom:"-8px"},onMouseDown:e=>N(e,"resize","bottom-right")})]})]}),(0,l.jsxs)("div",{className:"mt-4 text-sm text-gray-600 font-mono",children:[(0,l.jsx)("p",{children:"Drag the crop area to move it"}),(0,l.jsx)("p",{children:"Drag any corner to resize"}),(0,l.jsx)("p",{children:"Use the aspect ratio buttons above to lock the crop area to specific proportions"})]})]})})}function N(e){let t=parseInt(e=e.replace(/^#/,""),16);return[t>>16&255,t>>8&255,255&t]}function S(e,t,a){let l=Math.max(e/=255,t/=255,a/=255),n=Math.min(e,t,a),o=0,i=0,r=(l+n)/2;if(l!==n){let s=l-n;switch(i=r>.5?s/(2-l-n):s/(l+n),l){case e:o=(t-a)/s+(t<a?6:0);break;case t:o=(a-e)/s+2;break;case a:o=(e-t)/s+4}o/=6}return[o,i,r]}function I(e,t,a){let l=0,n=0,o=0;if(0===t)l=n=o=a;else{let i=(e,t,a)=>(a<0&&(a+=1),a>1&&(a-=1),a<1/6)?e+(t-e)*6*a:a<.5?t:a<2/3?e+(t-e)*(2/3-a)*6:e,r=a<.5?a*(1+t):a+t-a*t,s=2*a-r;l=i(s,r,e+1/3),n=i(s,r,e),o=i(s,r,e-1/3)}return[Math.round(255*l),Math.round(255*n),Math.round(255*o)]}a(9514);var z=e=>{let{label:t,value:a,onChange:n,min:o=0,max:i=100,step:r=1,unit:s=""}=e,c=null==a?o:a;return(0,l.jsxs)("div",{className:"slider-container",children:[(0,l.jsxs)("div",{className:"slider-label-container",children:[(0,l.jsx)("label",{className:"slider-label",children:t}),(0,l.jsxs)("span",{className:"slider-value",children:[null==a?"0":r>=1?Math.round(a).toString():a.toFixed(2),s]})]}),(0,l.jsxs)("div",{className:"slider-controls",children:[(0,l.jsx)("button",{type:"button",className:"slider-button",onClick:()=>{n(Math.max(o,c-r))},disabled:c<=o,children:"-"}),(0,l.jsx)("input",{type:"range",min:o,max:i,step:r,value:c,onChange:e=>n(parseFloat(e.target.value))}),(0,l.jsx)("button",{type:"button",className:"slider-button",onClick:()=>{n(Math.min(i,c+r))},disabled:c>=i,children:"+"})]})]})};let D=e=>{let t=new Blob([JSON.stringify(e,null,2)],{type:"application/json"});(0,s.saveAs)(t,"image-tweaker-settings.json")};var E=a(7996);let R=(e,t)=>{let a=(0,n.useRef)(null);return(0,n.useCallback)(function(){for(var l=arguments.length,n=Array(l),o=0;o<l;o++)n[o]=arguments[o];a.current&&clearTimeout(a.current),a.current=setTimeout(()=>{e(...n)},t)},[e,t])},O=e=>{if(!e||e.length<2)return"linear-gradient(to right, #000000, #ffffff)";let t=[...e].sort((e,t)=>e.position-t.position).map(e=>"".concat(e.color," ").concat(e.position,"%")).join(", ");return"linear-gradient(to right, ".concat(t,")")};var F=e=>{let{ditherSettings:t,halftoneSettings:a,colorSettings:o,thresholdSettings:i,glitchSettings:r,textDitherSettings:s,gradientMapSettings:c,gridSettings:h,effectInstances:d,instanceSettings:m,updateDitherSettings:g,updateHalftoneSettings:u,updateColorSettings:f,updateThresholdSettings:b,updateGlitchSettings:x,updateTextDitherSettings:p,updateGradientMapSettings:v,updateGridSettings:M,updateInstanceSettings:j,updateEffectInstances:y,addEffect:w,duplicateEffect:C,removeEffect:k,onResetImage:N,onExportPng:S,onExportSvg:I,onCropImage:D,blur:F,onBlurChange:A,onSettingsLoaded:L,mosaicShiftSettings:T,updateMosaicShiftSettings:B,sliceShiftSettings:P,updateSliceShiftSettings:Y,posterizeSettings:G,updatePosterizeSettings:U,findEdgesSettings:X,updateFindEdgesSettings:J}=e,[q,V]=(0,n.useState)(null);R(v,100),R(b,100),R(g,100);let H=e=>{q===e?V(""):V(e)},W=e=>{let t=d.findIndex(t=>t.id===e);if(t>0){let a=[...d];[a[t-1],a[t]]=[a[t],a[t-1]],y(a),V(e)}},_=e=>{let t=d.findIndex(t=>t.id===e);if(t<d.length-1){let a=[...d];[a[t],a[t+1]]=[a[t+1],a[t]],y(a),V(e)}},K=e=>(0,l.jsxs)("div",{className:"effect-action-buttons mr-2",children:[(0,l.jsx)("button",{className:"effect-action-btn",onClick:t=>{t.stopPropagation(),W(e.id)},title:"Move effect up",children:(0,l.jsx)(E.iRh,{size:16})}),(0,l.jsx)("button",{className:"effect-action-btn",onClick:t=>{t.stopPropagation(),_(e.id)},title:"Move effect down",children:(0,l.jsx)(E.tv1,{size:16})}),(0,l.jsx)("button",{className:"effect-action-btn",onClick:t=>{t.stopPropagation(),C(e.id)},title:"Duplicate effect",children:(0,l.jsx)(E.C3L,{size:16})}),(0,l.jsx)("button",{className:"effect-action-btn",onClick:t=>{t.stopPropagation(),k(e.id)},title:"Remove effect",children:(0,l.jsx)(E.Ybf,{size:16})})]}),$=(e,t)=>{y(d.map(a=>a.id===e?{...a,enabled:t}:a))},Q=(e,t)=>{let a=d.findIndex(t=>t.id===e.id);return(0,l.jsxs)("div",{className:"mobile-effect-header ".concat(q===e.id?"section-open":""),children:[(0,l.jsxs)("div",{className:"mobile-header-row effect-title-toggle-container",children:[(0,l.jsxs)("div",{className:"effect-title-container",children:[(0,l.jsx)("span",{className:"effect-order-number",children:a+1}),(0,l.jsx)("h3",{className:"mobile-effect-title",onClick:()=>H(e.id),children:t})]}),(0,l.jsxs)("label",{className:"mobile-effect-toggle",children:[(0,l.jsx)("input",{type:"checkbox",checked:e.enabled,onChange:t=>$(e.id,t.target.checked)}),(0,l.jsx)("span",{className:"mobile-effect-toggle-slider"})]})]}),(0,l.jsx)("div",{className:"mobile-header-row",children:(0,l.jsx)("div",{className:"effect-controls-container",children:K(e)})})]})},Z=e=>{if(m[e.id])return m[e.id];switch(e.type){case"color":return o;case"gradient":return c;case"threshold":return i;case"halftone":return a;case"grid":return h;case"dither":return t;case"textDither":return s;case"glitch":return r;case"blur":return F;default:return{}}},ee=e=>{if(q!==e.id)return null;let t=Z(e);switch(e.type){case"color":return(0,l.jsxs)("div",{className:"mobile-effect-content ".concat(q===e.id?"open":""),children:[(0,l.jsx)(z,{label:"Brightness",value:t.brightness,onChange:t=>j(e.id,{brightness:t}),min:0,max:200,step:1,unit:"%"}),(0,l.jsx)(z,{label:"Contrast",value:t.contrast,onChange:t=>j(e.id,{contrast:t}),min:0,max:200,step:1,unit:"%"}),(0,l.jsx)(z,{label:"Saturation",value:t.saturation,onChange:t=>j(e.id,{saturation:t}),min:0,max:200,step:1,unit:"%"}),(0,l.jsx)(z,{label:"Hue Shift",value:t.hueShift,onChange:t=>j(e.id,{hueShift:t}),min:-180,max:180,step:1,unit:"\xb0"}),(0,l.jsxs)("div",{className:"mobile-control-group",children:[(0,l.jsx)("label",{className:"mobile-control-label",children:"Invert Colors"}),(0,l.jsxs)("label",{className:"mobile-effect-toggle",children:[(0,l.jsx)("input",{type:"checkbox",checked:t.invert,onChange:t=>j(e.id,{invert:t.target.checked})}),(0,l.jsx)("span",{className:"mobile-effect-toggle-slider"})]})]})]});case"blur":return(0,l.jsxs)("div",{className:"mobile-effect-content ".concat(q===e.id?"open":""),children:[(0,l.jsxs)("div",{className:"mobile-control-group",children:[(0,l.jsx)("label",{className:"mobile-control-label",children:"Blur Type"}),(0,l.jsxs)("select",{className:"mobile-select",value:t.type||"gaussian",onChange:t=>j(e.id,{type:t.target.value}),children:[(0,l.jsx)("option",{value:"gaussian",children:"Gaussian"}),(0,l.jsx)("option",{value:"box",children:"Box"}),(0,l.jsx)("option",{value:"radial",children:"Radial"}),(0,l.jsx)("option",{value:"motion",children:"Motion"}),(0,l.jsx)("option",{value:"tiltshift",children:"Tilt Shift"})]})]}),(0,l.jsx)(z,{label:"Radius",value:t.radius||1,onChange:t=>j(e.id,{radius:t}),min:1,max:50,step:1,unit:"px"}),"radial"===t.type&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(z,{label:"Center X",value:t.centerX||50,onChange:t=>j(e.id,{centerX:t}),min:0,max:100,step:1}),(0,l.jsx)(z,{label:"Center Y",value:t.centerY||50,onChange:t=>j(e.id,{centerY:t}),min:0,max:100,step:1})]}),"motion"===t.type&&(0,l.jsx)(z,{label:"Angle",value:t.angle||0,onChange:t=>j(e.id,{angle:t}),min:0,max:360,step:1}),"tiltshift"===t.type&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(z,{label:"Focus Position",value:t.focusPosition||50,onChange:t=>j(e.id,{focusPosition:t}),min:0,max:100,step:1,unit:"%"}),(0,l.jsx)(z,{label:"Focus Width",value:t.focusWidth||25,onChange:t=>j(e.id,{focusWidth:t}),min:0,max:100,step:1,unit:"%"}),(0,l.jsx)(z,{label:"Angle",value:t.angle||0,onChange:t=>j(e.id,{angle:t}),min:0,max:180,step:1,unit:"\xb0"}),(0,l.jsx)(z,{label:"Gradient",value:t.gradient||12.5,onChange:t=>j(e.id,{gradient:t}),min:0,max:100,step:1,unit:"%"})]})]});case"gradient":let a=d.findIndex(t=>t.id===e.id);return(0,l.jsxs)("div",{className:"mobile-effect-content ".concat(q===e.id?"open":""),children:[(0,l.jsxs)("div",{className:"mobile-control-group",children:[(0,l.jsx)("label",{className:"mobile-control-label",children:"Blend Mode"}),(0,l.jsxs)("select",{className:"mobile-select",value:t.blendMode,onChange:t=>{j(e.id,{blendMode:t.target.value})},children:[(0,l.jsx)("option",{value:"normal",children:"Normal"}),(0,l.jsx)("option",{value:"multiply",children:"Multiply"}),(0,l.jsx)("option",{value:"screen",children:"Screen"}),(0,l.jsx)("option",{value:"overlay",children:"Overlay"}),(0,l.jsx)("option",{value:"darken",children:"Darken"}),(0,l.jsx)("option",{value:"lighten",children:"Lighten"}),(0,l.jsx)("option",{value:"color-dodge",children:"Color Dodge"}),(0,l.jsx)("option",{value:"color-burn",children:"Color Burn"}),(0,l.jsx)("option",{value:"hard-light",children:"Hard Light"}),(0,l.jsx)("option",{value:"soft-light",children:"Soft Light"}),(0,l.jsx)("option",{value:"difference",children:"Difference"}),(0,l.jsx)("option",{value:"exclusion",children:"Exclusion"}),(0,l.jsx)("option",{value:"hue",children:"Hue"}),(0,l.jsx)("option",{value:"saturation",children:"Saturation"}),(0,l.jsx)("option",{value:"color",children:"Color"}),(0,l.jsx)("option",{value:"luminosity",children:"Luminosity"})]})]}),(0,l.jsx)(z,{label:"Opacity",value:t.opacity,onChange:t=>j(e.id,{opacity:t}),min:0,max:1,step:.01,unit:"%"}),(0,l.jsx)("div",{className:"mobile-control-group mb-2",children:(0,l.jsx)("div",{className:"w-full h-12 rounded border border-[var(--border-color)] mt-1 shadow-inner",style:{background:O(t.stops)}})}),t.stops.map((n,o)=>(0,l.jsx)("div",{className:"mobile-control-group",children:(0,l.jsxs)("div",{className:"flex items-center gap-2 w-full",children:[(0,l.jsx)("input",{type:"color",className:"mobile-color-picker",style:{width:"32px",minWidth:"32px",height:"32px"},value:n.color,onChange:a=>{let l=[...t.stops];l[o]={...n,color:a.target.value},j(e.id,{stops:l})}}),(0,l.jsx)("input",{type:"range",className:"flex-grow",min:"0",max:"100",value:n.position,onChange:a=>{let l=parseInt(a.target.value),i=[...t.stops];i[o]={...n,position:l},j(e.id,{stops:i})}}),(0,l.jsxs)("span",{className:"text-xs text-[var(--text-secondary)] w-10 text-right",children:[n.position,"%"]}),t.stops.length>2&&(0,l.jsx)("button",{className:"slider-button",onClick:()=>{let a=t.stops.filter((e,t)=>t!==o);j(e.id,{stops:a})},"aria-label":"Remove color stop",children:"âœ•"})]})},"stop-".concat(a,"-").concat(o))),(0,l.jsx)("div",{className:"mobile-control-group mt-3",children:(0,l.jsx)("button",{className:"mobile-action-button w-full",onClick:()=>{let a=[...t.stops].sort((e,t)=>e.position-t.position),l=50;if(a.length>=2){let e=0,t=0;for(let l=0;l<a.length-1;l++){let n=a[l+1].position-a[l].position;n>e&&(e=n,t=a[l].position+n/2)}l=Math.round(t)}let n="#".concat(Math.floor(16777215*Math.random()).toString(16).padStart(6,"0")),o=[...t.stops,{position:l,color:n}];j(e.id,{stops:o})},children:"+ Add Color Stop"})})]});case"threshold":return(0,l.jsxs)("div",{className:"mobile-effect-content ".concat(q===e.id?"open":""),children:[(0,l.jsxs)("div",{className:"mobile-control-group",children:[(0,l.jsx)("label",{className:"mobile-control-label",children:"Mode"}),(0,l.jsxs)("select",{className:"mobile-select",value:t.mode,onChange:t=>j(e.id,{mode:t.target.value}),children:[(0,l.jsx)("option",{value:"solid",children:"Solid"}),(0,l.jsx)("option",{value:"gradient",children:"Gradient"})]})]}),(0,l.jsx)(z,{label:"Threshold",value:t.threshold,onChange:t=>j(e.id,{threshold:t}),min:0,max:255,step:1}),"solid"===t.mode&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"mobile-control-group",children:[(0,l.jsx)("label",{className:"mobile-control-label",children:"Dark Color"}),(0,l.jsx)("input",{type:"color",className:"mobile-color-picker",value:t.darkColor,onChange:t=>j(e.id,{darkColor:t.target.value})})]}),(0,l.jsxs)("div",{className:"mobile-control-group",children:[(0,l.jsx)("label",{className:"mobile-control-label",children:"Light Color"}),(0,l.jsx)("input",{type:"color",className:"mobile-color-picker",value:t.lightColor,onChange:t=>j(e.id,{lightColor:t.target.value})})]})]}),"gradient"===t.mode&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"mobile-control-group",children:[(0,l.jsx)("label",{className:"mobile-control-label",children:"Dark Color Start"}),(0,l.jsx)("input",{type:"color",className:"mobile-color-picker",value:t.darkColorStart,onChange:t=>j(e.id,{darkColorStart:t.target.value})})]}),(0,l.jsxs)("div",{className:"mobile-control-group",children:[(0,l.jsx)("label",{className:"mobile-control-label",children:"Dark Color End"}),(0,l.jsx)("input",{type:"color",className:"mobile-color-picker",value:t.darkColorEnd,onChange:t=>j(e.id,{darkColorEnd:t.target.value})})]}),(0,l.jsxs)("div",{className:"mobile-control-group",children:[(0,l.jsx)("label",{className:"mobile-control-label",children:"Light Color Start"}),(0,l.jsx)("input",{type:"color",className:"mobile-color-picker",value:t.lightColorStart,onChange:t=>j(e.id,{lightColorStart:t.target.value})})]}),(0,l.jsxs)("div",{className:"mobile-control-group",children:[(0,l.jsx)("label",{className:"mobile-control-label",children:"Light Color End"}),(0,l.jsx)("input",{type:"color",className:"mobile-color-picker",value:t.lightColorEnd,onChange:t=>j(e.id,{lightColorEnd:t.target.value})})]})]})]});case"dither":return(0,l.jsxs)("div",{className:"mobile-effect-content ".concat(q===e.id?"open":""),children:[(0,l.jsxs)("div",{className:"mobile-control-group",children:[(0,l.jsx)("label",{className:"mobile-control-label",children:"Dither Type"}),(0,l.jsxs)("select",{className:"mobile-select",value:t.type||"floyd-steinberg",onChange:t=>j(e.id,{type:t.target.value}),children:[(0,l.jsx)("option",{value:"floyd-steinberg",children:"Floyd-Steinberg"}),(0,l.jsx)("option",{value:"ordered",children:"Ordered"}),(0,l.jsx)("option",{value:"jarvis",children:"Jarvis"}),(0,l.jsx)("option",{value:"judice-ninke",children:"Judice-Ninke"}),(0,l.jsx)("option",{value:"stucki",children:"Stucki"}),(0,l.jsx)("option",{value:"burkes",children:"Burkes"})]})]}),(0,l.jsx)(z,{label:"Resolution",value:t.resolution||30,onChange:t=>j(e.id,{resolution:t}),min:1,max:100,step:1,unit:"%"}),(0,l.jsx)(z,{label:"Threshold",value:t.threshold||128,onChange:t=>j(e.id,{threshold:t}),min:0,max:255,step:1}),(0,l.jsxs)("div",{className:"mobile-control-group",children:[(0,l.jsx)("label",{className:"mobile-control-label",children:"Color Mode"}),(0,l.jsxs)("select",{className:"mobile-select",value:t.colorMode||"grayscale",onChange:t=>j(e.id,{colorMode:t.target.value}),children:[(0,l.jsx)("option",{value:"grayscale",children:"Grayscale"}),(0,l.jsx)("option",{value:"color",children:"Color"}),(0,l.jsx)("option",{value:"2-color",children:"2-Color"})]})]}),"2-color"!==t.colorMode&&(0,l.jsx)(z,{label:"Color Depth",value:t.colorDepth||2,onChange:t=>j(e.id,{colorDepth:t}),min:2,max:256,step:1,unit:" colors"}),"2-color"===t.colorMode&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"mobile-control-group",children:[(0,l.jsx)("label",{className:"mobile-control-label",children:"Dark Color"}),(0,l.jsx)("input",{type:"color",className:"mobile-color-picker",value:t.darkColor||"#000000",onChange:t=>j(e.id,{darkColor:t.target.value})})]}),(0,l.jsxs)("div",{className:"mobile-control-group",children:[(0,l.jsx)("label",{className:"mobile-control-label",children:"Light Color"}),(0,l.jsx)("input",{type:"color",className:"mobile-color-picker",value:t.lightColor||"#FFFFFF",onChange:t=>j(e.id,{lightColor:t.target.value})})]})]})]});case"halftone":return(0,l.jsxs)("div",{className:"mobile-effect-content ".concat(q===e.id?"open":""),children:[(0,l.jsxs)("div",{className:"mobile-control-group",children:[(0,l.jsx)("label",{className:"mobile-control-label",children:"Shape"}),(0,l.jsxs)("select",{className:"mobile-select",value:t.shape,onChange:t=>j(e.id,{shape:t.target.value}),children:[(0,l.jsx)("option",{value:"circle",children:"Circle"}),(0,l.jsx)("option",{value:"square",children:"Square"}),(0,l.jsx)("option",{value:"diamond",children:"Diamond"}),(0,l.jsx)("option",{value:"line",children:"Line"}),(0,l.jsx)("option",{value:"cross",children:"Cross"}),(0,l.jsx)("option",{value:"ellipse",children:"Ellipse"}),(0,l.jsx)("option",{value:"triangle",children:"Triangle"}),(0,l.jsx)("option",{value:"hexagon",children:"Hexagon"})]})]}),(0,l.jsxs)("div",{className:"mobile-control-group",children:[(0,l.jsx)("label",{className:"mobile-control-label",children:"Pattern"}),(0,l.jsxs)("select",{className:"mobile-select",value:t.arrangement,onChange:t=>j(e.id,{arrangement:t.target.value}),children:[(0,l.jsx)("option",{value:"grid",children:"Grid"}),(0,l.jsx)("option",{value:"hexagonal",children:"Hexagonal"}),(0,l.jsx)("option",{value:"spiral",children:"Spiral"}),(0,l.jsx)("option",{value:"concentric",children:"Concentric"}),(0,l.jsx)("option",{value:"random",children:"Random"})]})]}),(0,l.jsx)(z,{label:"Cell Size",value:t.cellSize,onChange:t=>j(e.id,{cellSize:t}),min:2,max:30,step:1,unit:"px"}),(0,l.jsx)(z,{label:"Dot Scale",value:t.dotScaleFactor,onChange:t=>j(e.id,{dotScaleFactor:t}),min:.1,max:1.5,step:.05}),(0,l.jsx)(z,{label:"Mix Amount",value:t.mix,onChange:t=>j(e.id,{mix:t}),min:0,max:100,step:1,unit:"%"}),(0,l.jsxs)("div",{className:"mobile-control-group",children:[(0,l.jsx)("label",{className:"mobile-control-label",children:"Colored"}),(0,l.jsxs)("label",{className:"mobile-effect-toggle",children:[(0,l.jsx)("input",{type:"checkbox",checked:t.colored,onChange:t=>j(e.id,{colored:t.target.checked})}),(0,l.jsx)("span",{className:"mobile-effect-toggle-slider"})]})]}),(0,l.jsxs)("div",{className:"mobile-control-group",children:[(0,l.jsx)("label",{className:"mobile-control-label",children:"Invert"}),(0,l.jsxs)("label",{className:"mobile-effect-toggle",children:[(0,l.jsx)("input",{type:"checkbox",checked:t.invertBrightness,onChange:t=>j(e.id,{invertBrightness:t.target.checked})}),(0,l.jsx)("span",{className:"mobile-effect-toggle-slider"})]})]})]});case"textDither":return(0,l.jsxs)("div",{className:"mobile-effect-content ".concat(q===e.id?"open":""),children:[(0,l.jsxs)("div",{className:"mobile-control-group",children:[(0,l.jsx)("label",{className:"mobile-control-label",children:"Text Pattern"}),(0,l.jsx)("input",{type:"text",className:"mobile-select",value:t.text,onChange:t=>j(e.id,{text:t.target.value})})]}),(0,l.jsx)(z,{label:"Font Size",value:t.fontSize,onChange:t=>j(e.id,{fontSize:t}),min:6,max:24,step:1,unit:"px"}),(0,l.jsx)(z,{label:"Resolution",value:t.resolution,onChange:t=>j(e.id,{resolution:t}),min:.5,max:4,step:.1}),(0,l.jsxs)("div",{className:"mobile-control-group",children:[(0,l.jsx)("label",{className:"mobile-control-label",children:"Color Mode"}),(0,l.jsxs)("select",{className:"mobile-select",value:t.colorMode,onChange:t=>j(e.id,{colorMode:t.target.value}),children:[(0,l.jsx)("option",{value:"monochrome",children:"Monochrome"}),(0,l.jsx)("option",{value:"colored",children:"Colored"})]})]}),(0,l.jsx)(z,{label:"Contrast",value:t.contrast,onChange:t=>j(e.id,{contrast:t}),min:0,max:2,step:.1})]});case"glitch":return(0,l.jsxs)("div",{className:"mobile-effect-content ".concat(q===e.id?"open":""),children:[(0,l.jsxs)("div",{className:"mobile-control-group",children:[(0,l.jsx)("label",{className:"mobile-control-label",children:"General Glitch"}),(0,l.jsx)("div",{className:"mobile-toggle-container",children:(0,l.jsxs)("label",{className:"mobile-effect-toggle",children:[(0,l.jsx)("input",{type:"checkbox",checked:t.enabled,onChange:t=>j(e.id,{enabled:t.target.checked})}),(0,l.jsx)("span",{className:"mobile-effect-toggle-slider"})]})})]}),t.enabled&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(z,{label:"Intensity",value:t.glitchIntensity,onChange:t=>j(e.id,{glitchIntensity:t}),min:0,max:100,step:1,unit:"%"}),(0,l.jsx)(z,{label:"Density",value:t.glitchDensity,onChange:t=>j(e.id,{glitchDensity:t}),min:0,max:100,step:1,unit:"%"}),(0,l.jsx)(z,{label:"Size",value:t.glitchSize,onChange:t=>j(e.id,{glitchSize:t}),min:1,max:50,step:1,unit:"px"}),(0,l.jsxs)("div",{className:"mobile-control-group",children:[(0,l.jsx)("label",{className:"mobile-control-label",children:"Direction"}),(0,l.jsxs)("select",{className:"mobile-select",value:t.glitchDirection,onChange:t=>j(e.id,{glitchDirection:t.target.value}),children:[(0,l.jsx)("option",{value:"horizontal",children:"Horizontal"}),(0,l.jsx)("option",{value:"vertical",children:"Vertical"}),(0,l.jsx)("option",{value:"both",children:"Both"})]})]})]}),(0,l.jsxs)("div",{className:"mobile-control-group",children:[(0,l.jsx)("label",{className:"mobile-control-label",children:"Channel Shift"}),(0,l.jsx)("div",{className:"mobile-toggle-container",children:(0,l.jsxs)("label",{className:"mobile-effect-toggle",children:[(0,l.jsx)("input",{type:"checkbox",checked:t.channelShiftEnabled,onChange:t=>j(e.id,{channelShiftEnabled:t.target.checked})}),(0,l.jsx)("span",{className:"mobile-effect-toggle-slider"})]})})]}),t.channelShiftEnabled&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(z,{label:"Shift Amount",value:t.channelShiftAmount,onChange:t=>j(e.id,{channelShiftAmount:t}),min:1,max:20,step:1,unit:"px"}),(0,l.jsxs)("div",{className:"mobile-control-group",children:[(0,l.jsx)("label",{className:"mobile-control-label",children:"Shift Mode"}),(0,l.jsxs)("select",{className:"mobile-select",value:t.channelShiftMode,onChange:t=>j(e.id,{channelShiftMode:t.target.value}),children:[(0,l.jsx)("option",{value:"rgb",children:"RGB"}),(0,l.jsx)("option",{value:"rb",children:"RB"}),(0,l.jsx)("option",{value:"rg",children:"RG"}),(0,l.jsx)("option",{value:"gb",children:"GB"})]})]})]}),(0,l.jsxs)("div",{className:"mobile-control-group",children:[(0,l.jsx)("label",{className:"mobile-control-label",children:"Noise"}),(0,l.jsx)("div",{className:"mobile-toggle-container",children:(0,l.jsxs)("label",{className:"mobile-effect-toggle",children:[(0,l.jsx)("input",{type:"checkbox",checked:t.noiseEnabled,onChange:t=>j(e.id,{noiseEnabled:t.target.checked})}),(0,l.jsx)("span",{className:"mobile-effect-toggle-slider"})]})})]}),t.noiseEnabled&&(0,l.jsx)(z,{label:"Noise Amount",value:t.noiseAmount,onChange:t=>j(e.id,{noiseAmount:t}),min:0,max:100,step:1,unit:"%"}),(0,l.jsxs)("div",{className:"mobile-control-group",children:[(0,l.jsx)("label",{className:"mobile-control-label",children:"Pixel Sorting"}),(0,l.jsx)("div",{className:"mobile-toggle-container",children:(0,l.jsxs)("label",{className:"mobile-effect-toggle",children:[(0,l.jsx)("input",{type:"checkbox",checked:t.pixelSortingEnabled,onChange:t=>j(e.id,{pixelSortingEnabled:t.target.checked})}),(0,l.jsx)("span",{className:"mobile-effect-toggle-slider"})]})})]}),t.pixelSortingEnabled&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(z,{label:"Threshold",value:t.pixelSortingThreshold,onChange:t=>j(e.id,{pixelSortingThreshold:t}),min:0,max:1,step:.01}),(0,l.jsxs)("div",{className:"mobile-control-group",children:[(0,l.jsx)("label",{className:"mobile-control-label",children:"Direction"}),(0,l.jsxs)("select",{className:"mobile-select",value:t.pixelSortingDirection,onChange:t=>j(e.id,{pixelSortingDirection:t.target.value}),children:[(0,l.jsx)("option",{value:"horizontal",children:"Horizontal"}),(0,l.jsx)("option",{value:"vertical",children:"Vertical"}),(0,l.jsx)("option",{value:"both",children:"Both"})]})]})]}),(0,l.jsxs)("div",{className:"mobile-control-group",children:[(0,l.jsx)("label",{className:"mobile-control-label",children:"Scan Lines"}),(0,l.jsx)("div",{className:"mobile-toggle-container",children:(0,l.jsxs)("label",{className:"mobile-effect-toggle",children:[(0,l.jsx)("input",{type:"checkbox",checked:t.scanLinesEnabled,onChange:t=>j(e.id,{scanLinesEnabled:t.target.checked})}),(0,l.jsx)("span",{className:"mobile-effect-toggle-slider"})]})})]}),t.scanLinesEnabled&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(z,{label:"Count",value:t.scanLinesCount,onChange:t=>j(e.id,{scanLinesCount:t}),min:1,max:100,step:1}),(0,l.jsx)(z,{label:"Intensity",value:t.scanLinesIntensity,onChange:t=>j(e.id,{scanLinesIntensity:t}),min:0,max:100,step:1,unit:"%"}),(0,l.jsxs)("div",{className:"mobile-control-group",children:[(0,l.jsx)("label",{className:"mobile-control-label",children:"Direction"}),(0,l.jsxs)("select",{className:"mobile-select",value:t.scanLinesDirection,onChange:t=>j(e.id,{scanLinesDirection:t.target.value}),children:[(0,l.jsx)("option",{value:"horizontal",children:"Horizontal"}),(0,l.jsx)("option",{value:"vertical",children:"Vertical"}),(0,l.jsx)("option",{value:"both",children:"Both"})]})]})]}),(0,l.jsxs)("div",{className:"mobile-control-group",children:[(0,l.jsx)("label",{className:"mobile-control-label",children:"Blocks"}),(0,l.jsx)("div",{className:"mobile-toggle-container",children:(0,l.jsxs)("label",{className:"mobile-effect-toggle",children:[(0,l.jsx)("input",{type:"checkbox",checked:t.blocksEnabled,onChange:t=>j(e.id,{blocksEnabled:t.target.checked})}),(0,l.jsx)("span",{className:"mobile-effect-toggle-slider"})]})})]}),t.blocksEnabled&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(z,{label:"Size",value:t.blocksSize,onChange:t=>j(e.id,{blocksSize:t}),min:5,max:50,step:1,unit:"px"}),(0,l.jsx)(z,{label:"Offset",value:t.blocksOffset,onChange:t=>j(e.id,{blocksOffset:t}),min:0,max:50,step:1,unit:"%"}),(0,l.jsx)(z,{label:"Density",value:t.blocksDensity,onChange:t=>j(e.id,{blocksDensity:t}),min:0,max:100,step:1,unit:"%"})]})]});case"grid":return(0,l.jsxs)("div",{className:"mobile-effect-content ".concat(q===e.id?"open":""),children:[(0,l.jsx)(z,{label:"Columns",value:t.columns,onChange:t=>j(e.id,{columns:t}),min:1,max:10,step:1}),(0,l.jsx)(z,{label:"Rows",value:t.rows,onChange:t=>j(e.id,{rows:t}),min:1,max:10,step:1}),(0,l.jsxs)("div",{className:"mobile-control-group",children:[(0,l.jsx)("label",{className:"mobile-control-label",children:"Apply Rotation"}),(0,l.jsxs)("label",{className:"mobile-effect-toggle",children:[(0,l.jsx)("input",{type:"checkbox",checked:t.applyRotation,onChange:t=>j(e.id,{applyRotation:t.target.checked})}),(0,l.jsx)("span",{className:"mobile-effect-toggle-slider"})]})]}),t.applyRotation&&(0,l.jsx)(z,{label:"Max Rotation",value:t.maxRotation,onChange:t=>j(e.id,{maxRotation:t}),min:1,max:45,step:1,unit:"\xb0"}),(0,l.jsxs)("div",{className:"mobile-control-group",children:[(0,l.jsx)("label",{className:"mobile-control-label",children:"Split Cells"}),(0,l.jsxs)("label",{className:"mobile-effect-toggle",children:[(0,l.jsx)("input",{type:"checkbox",checked:t.splitEnabled,onChange:t=>j(e.id,{splitEnabled:t.target.checked})}),(0,l.jsx)("span",{className:"mobile-effect-toggle-slider"})]})]}),t.splitEnabled&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(z,{label:"Split Probability",value:t.splitProbability,onChange:t=>j(e.id,{splitProbability:t}),min:0,max:1,step:.05,unit:""}),(0,l.jsx)(z,{label:"Max Split Levels",value:t.maxSplitLevels,onChange:t=>j(e.id,{maxSplitLevels:t}),min:1,max:4,step:1}),(0,l.jsx)(z,{label:"Min Cell Size",value:t.minCellSize,onChange:t=>j(e.id,{minCellSize:t}),min:10,max:100,step:5,unit:"px"})]})]});case"mosaicShift":return(0,l.jsxs)("div",{className:"mobile-effect-content ".concat(q===e.id?"open":""),children:[(0,l.jsx)(z,{label:"Columns",value:t.columns,onChange:t=>j(e.id,{columns:t}),min:2,max:20,step:1}),(0,l.jsx)(z,{label:"Rows",value:t.rows,onChange:t=>j(e.id,{rows:t}),min:2,max:20,step:1}),(0,l.jsx)(z,{label:"Max X Offset",value:t.maxOffsetX,onChange:t=>j(e.id,{maxOffsetX:t}),min:0,max:200,step:1,unit:"px"}),(0,l.jsx)(z,{label:"Max Y Offset",value:t.maxOffsetY,onChange:t=>j(e.id,{maxOffsetY:t}),min:0,max:200,step:1,unit:"px"}),(0,l.jsx)(z,{label:"Intensity",value:t.intensity,onChange:t=>j(e.id,{intensity:t}),min:0,max:100,step:1,unit:"%"}),(0,l.jsxs)("div",{className:"mobile-control-group",children:[(0,l.jsx)("label",{className:"mobile-control-label",children:"Shift Pattern"}),(0,l.jsxs)("select",{className:"mobile-select",value:t.pattern,onChange:t=>j(e.id,{pattern:t.target.value}),children:[(0,l.jsx)("option",{value:"random",children:"Random"}),(0,l.jsx)("option",{value:"wave",children:"Wave"}),(0,l.jsx)("option",{value:"radial",children:"Radial"}),(0,l.jsx)("option",{value:"spiral",children:"Spiral"})]})]}),(0,l.jsxs)("div",{className:"mobile-control-group",children:[(0,l.jsx)("label",{className:"mobile-control-label",children:"Preserve Edges"}),(0,l.jsxs)("label",{className:"mobile-effect-toggle",children:[(0,l.jsx)("input",{type:"checkbox",checked:t.preserveEdges,onChange:t=>j(e.id,{preserveEdges:t.target.checked})}),(0,l.jsx)("span",{className:"mobile-effect-toggle-slider"})]})]}),(0,l.jsxs)("div",{className:"mobile-control-group",children:[(0,l.jsx)("label",{className:"mobile-control-label",children:"Random Rotation"}),(0,l.jsxs)("label",{className:"mobile-effect-toggle",children:[(0,l.jsx)("input",{type:"checkbox",checked:t.randomRotation,onChange:t=>j(e.id,{randomRotation:t.target.checked})}),(0,l.jsx)("span",{className:"mobile-effect-toggle-slider"})]})]}),t.randomRotation&&(0,l.jsx)(z,{label:"Max Rotation",value:t.maxRotation,onChange:t=>j(e.id,{maxRotation:t}),min:0,max:180,step:1,unit:"\xb0"}),(0,l.jsxs)("div",{className:"mobile-control-group",children:[(0,l.jsx)("label",{className:"mobile-control-label",children:"Use Background Color"}),(0,l.jsxs)("label",{className:"mobile-effect-toggle",children:[(0,l.jsx)("input",{type:"checkbox",checked:t.useBackgroundColor,onChange:t=>j(e.id,{useBackgroundColor:t.target.checked})}),(0,l.jsx)("span",{className:"mobile-effect-toggle-slider"})]})]}),t.useBackgroundColor&&(0,l.jsxs)("div",{className:"mobile-control-group",children:[(0,l.jsx)("label",{className:"mobile-control-label",children:"Background Color"}),(0,l.jsx)("input",{type:"color",className:"mobile-color-picker",value:t.backgroundColor||"#000000",onChange:t=>j(e.id,{backgroundColor:t.target.value})})]}),(0,l.jsx)("div",{className:"mobile-control-group",children:(0,l.jsx)("button",{className:"mobile-action-button w-full",onClick:()=>j(e.id,{seed:1e3*Math.random()}),children:"Randomize"})})]});case"sliceShift":return(0,l.jsxs)("div",{className:"mobile-effect-content ".concat(q===e.id?"open":""),children:[(0,l.jsx)(z,{label:"Number of Slices",value:t.slices,onChange:t=>j(e.id,{slices:t}),min:5,max:100,step:1}),(0,l.jsxs)("div",{className:"mobile-control-group",children:[(0,l.jsx)("label",{className:"mobile-control-label",children:"Direction"}),(0,l.jsxs)("select",{className:"mobile-select",value:t.direction,onChange:t=>j(e.id,{direction:t.target.value}),children:[(0,l.jsx)("option",{value:"vertical",children:"Vertical Slices"}),(0,l.jsx)("option",{value:"horizontal",children:"Horizontal Slices"}),(0,l.jsx)("option",{value:"both",children:"Both Directions"})]})]}),(0,l.jsxs)("div",{className:"mobile-control-group",children:[(0,l.jsx)("label",{className:"mobile-control-label",children:"Effect Mode"}),(0,l.jsxs)("select",{className:"mobile-select",value:t.mode,onChange:t=>j(e.id,{mode:t.target.value}),children:[(0,l.jsx)("option",{value:"random",children:"Random Offset"}),(0,l.jsx)("option",{value:"alternating",children:"Alternating Offset"}),(0,l.jsx)("option",{value:"wave",children:"Wave Offset"}),(0,l.jsx)("option",{value:"rearrange",children:"Rearrange Slices"}),(0,l.jsx)("option",{value:"repeat",children:"Repeat Slices"})]})]}),"rearrange"===t.mode&&(0,l.jsxs)("div",{className:"mobile-control-group",children:[(0,l.jsx)("label",{className:"mobile-control-label",children:"Rearrange Pattern"}),(0,l.jsxs)("select",{className:"mobile-select",value:t.rearrangeMode,onChange:t=>j(e.id,{rearrangeMode:t.target.value}),children:[(0,l.jsx)("option",{value:"random",children:"Random"}),(0,l.jsx)("option",{value:"reverse",children:"Reverse"}),(0,l.jsx)("option",{value:"alternate",children:"Alternate (even/odd)"}),(0,l.jsx)("option",{value:"shuffle",children:"Shuffle"})]})]}),("random"===t.mode||"alternating"===t.mode||"wave"===t.mode)&&(0,l.jsx)(z,{label:"Max Offset",value:t.maxOffset,onChange:t=>j(e.id,{maxOffset:t}),min:0,max:100,step:1,unit:"px"}),("random"===t.mode||"alternating"===t.mode||"wave"===t.mode)&&(0,l.jsx)(z,{label:"Intensity",value:t.intensity,onChange:t=>j(e.id,{intensity:t}),min:0,max:100,step:1,unit:"%"}),(0,l.jsxs)("div",{className:"mobile-control-group",children:[(0,l.jsx)("label",{className:"mobile-control-label",children:"Edge Feathering"}),(0,l.jsxs)("label",{className:"mobile-effect-toggle",children:[(0,l.jsx)("input",{type:"checkbox",checked:t.feathering,onChange:t=>j(e.id,{feathering:t.target.checked})}),(0,l.jsx)("span",{className:"mobile-effect-toggle-slider"})]})]}),t.feathering&&(0,l.jsx)(z,{label:"Feather Amount",value:t.featherAmount,onChange:t=>j(e.id,{featherAmount:t}),min:0,max:100,step:1,unit:"%"}),(0,l.jsxs)("div",{className:"mobile-control-group",children:[(0,l.jsx)("label",{className:"mobile-control-label",children:"Use Background Color"}),(0,l.jsxs)("label",{className:"mobile-effect-toggle",children:[(0,l.jsx)("input",{type:"checkbox",checked:t.useBackgroundColor,onChange:t=>j(e.id,{useBackgroundColor:t.target.checked})}),(0,l.jsx)("span",{className:"mobile-effect-toggle-slider"})]})]}),t.useBackgroundColor&&(0,l.jsxs)("div",{className:"mobile-control-group",children:[(0,l.jsx)("label",{className:"mobile-control-label",children:"Background Color"}),(0,l.jsx)("input",{type:"color",className:"mobile-color-picker",value:t.backgroundColor||"#000000",onChange:t=>j(e.id,{backgroundColor:t.target.value})})]}),(0,l.jsx)("div",{className:"mobile-control-group",children:(0,l.jsx)("button",{className:"mobile-action-button w-full",onClick:()=>j(e.id,{seed:1e3*Math.random()}),children:"Randomize"})})]});case"posterize":return(0,l.jsxs)("div",{className:"mobile-effect-content ".concat(q===e.id?"open":""),children:[(0,l.jsx)(z,{label:"Levels",value:t.levels,onChange:t=>j(e.id,{levels:t}),min:2,max:256,step:1}),(0,l.jsxs)("div",{className:"mobile-control-group",children:[(0,l.jsx)("label",{className:"mobile-control-label",children:"Color Mode"}),(0,l.jsxs)("select",{className:"mobile-select",value:t.colorMode,onChange:t=>j(e.id,{colorMode:t.target.value}),children:[(0,l.jsx)("option",{value:"rgb",children:"RGB"}),(0,l.jsx)("option",{value:"hsv",children:"HSV"}),(0,l.jsx)("option",{value:"lab",children:"LAB"})]})]}),(0,l.jsxs)("div",{className:"mobile-control-group",children:[(0,l.jsx)("label",{className:"mobile-control-label",children:"Preserve Luminance"}),(0,l.jsxs)("label",{className:"mobile-effect-toggle",children:[(0,l.jsx)("input",{type:"checkbox",checked:t.preserveLuminance,onChange:t=>j(e.id,{preserveLuminance:t.target.checked})}),(0,l.jsx)("span",{className:"mobile-effect-toggle-slider"})]})]}),(0,l.jsxs)("div",{className:"mobile-control-group",children:[(0,l.jsx)("label",{className:"mobile-control-label",children:"Dithering"}),(0,l.jsxs)("label",{className:"mobile-effect-toggle",children:[(0,l.jsx)("input",{type:"checkbox",checked:t.dithering,onChange:t=>j(e.id,{dithering:t.target.checked})}),(0,l.jsx)("span",{className:"mobile-effect-toggle-slider"})]})]}),t.dithering&&(0,l.jsx)(z,{label:"Dither Amount",value:t.ditherAmount,onChange:t=>j(e.id,{ditherAmount:t}),min:0,max:100,step:1,unit:"%"})]});case"findEdges":return(0,l.jsxs)("div",{className:"mobile-effect-content ".concat(q===e.id?"open":""),children:[(0,l.jsxs)("div",{className:"mobile-control-group",children:[(0,l.jsx)("label",{className:"mobile-control-label",children:"Algorithm"}),(0,l.jsxs)("select",{className:"mobile-select",value:t.algorithm,onChange:t=>j(e.id,{algorithm:t.target.value}),children:[(0,l.jsx)("option",{value:"sobel",children:"Sobel"}),(0,l.jsx)("option",{value:"prewitt",children:"Prewitt"}),(0,l.jsx)("option",{value:"canny",children:"Canny"}),(0,l.jsx)("option",{value:"laplacian",children:"Laplacian"})]})]}),(0,l.jsx)(z,{label:"Intensity",value:t.intensity,onChange:t=>j(e.id,{intensity:t}),min:0,max:100,step:1,unit:"%"}),(0,l.jsx)(z,{label:"Threshold",value:t.threshold,onChange:t=>j(e.id,{threshold:t}),min:0,max:255,step:1}),(0,l.jsxs)("div",{className:"mobile-control-group",children:[(0,l.jsx)("label",{className:"mobile-control-label",children:"Color Mode"}),(0,l.jsxs)("select",{className:"mobile-select",value:t.colorMode,onChange:t=>j(e.id,{colorMode:t.target.value}),children:[(0,l.jsx)("option",{value:"grayscale",children:"Grayscale"}),(0,l.jsx)("option",{value:"color",children:"Color"}),(0,l.jsx)("option",{value:"inverted",children:"Inverted"})]})]}),(0,l.jsxs)("div",{className:"mobile-control-group",children:[(0,l.jsx)("label",{className:"mobile-control-label",children:"Invert"}),(0,l.jsxs)("label",{className:"mobile-effect-toggle",children:[(0,l.jsx)("input",{type:"checkbox",checked:t.invert,onChange:t=>j(e.id,{invert:t.target.checked})}),(0,l.jsx)("span",{className:"mobile-effect-toggle-slider"})]})]}),(0,l.jsx)(z,{label:"Blur Radius",value:t.blurRadius,onChange:t=>j(e.id,{blurRadius:t}),min:0,max:10,step:.5,unit:"px"})]});default:return null}},et=e=>{let t=d.filter(t=>t.type===e.type),a=t.length,n=t.findIndex(t=>t.id===e.id),o="color"===e.type?"Color Adjustments":"halftone"===e.type?"Halftone Effect":"grid"===e.type?"Grid Effect":"dither"===e.type?"Dithering":"textDither"===e.type?"Text Dithering":"glitch"===e.type?"Glitch Effect":"blur"===e.type?"Blur Effect":"gradient"===e.type?"Gradient Map":"threshold"===e.type?"Threshold":"mosaicShift"===e.type?"Mosaic":"sliceShift"===e.type?"Slice":"posterize"===e.type?"Posterize":"findEdges"===e.type?"Find Edges":"Effect",i=a>1?"".concat(o," ").concat(n+1):o;return(0,l.jsxs)("div",{className:"mobile-effect-section",children:[Q(e,i),ee(e)]},e.id)};return(0,l.jsx)("div",{className:"mobile-controls",children:(0,l.jsxs)("div",{className:"mobile-controls-panel",children:[d.map(e=>et(e)),d.length>0&&(0,l.jsx)("div",{className:"add-effect-label",children:"Add Effect"}),0===d.length&&(0,l.jsx)("div",{className:"add-first-effect-label",children:"Add Effect"}),(0,l.jsxs)("div",{className:"effect-buttons-container",children:[(0,l.jsxs)("button",{className:"plain-effect-btn",onClick:()=>w("color"),children:[(0,l.jsx)(E.OvN,{size:12})," Color"]}),(0,l.jsxs)("button",{className:"plain-effect-btn",onClick:()=>w("blur"),children:[(0,l.jsx)(E.OvN,{size:12})," Blur"]}),(0,l.jsxs)("button",{className:"plain-effect-btn",onClick:()=>w("gradient"),children:[(0,l.jsx)(E.OvN,{size:12})," Gradient"]}),(0,l.jsxs)("button",{className:"plain-effect-btn",onClick:()=>w("threshold"),children:[(0,l.jsx)(E.OvN,{size:12})," Threshold"]}),(0,l.jsxs)("button",{className:"plain-effect-btn",onClick:()=>w("dither"),children:[(0,l.jsx)(E.OvN,{size:12})," Dither"]}),(0,l.jsxs)("button",{className:"plain-effect-btn",onClick:()=>w("halftone"),children:[(0,l.jsx)(E.OvN,{size:12})," Halftone"]}),(0,l.jsxs)("button",{className:"plain-effect-btn",onClick:()=>w("textDither"),children:[(0,l.jsx)(E.OvN,{size:12})," Text"]}),(0,l.jsxs)("button",{className:"plain-effect-btn",onClick:()=>w("glitch"),children:[(0,l.jsx)(E.OvN,{size:12})," Glitch"]}),(0,l.jsxs)("button",{className:"plain-effect-btn",onClick:()=>w("grid"),children:[(0,l.jsx)(E.OvN,{size:12})," Grid"]}),(0,l.jsxs)("button",{className:"plain-effect-btn",onClick:()=>w("mosaicShift"),children:[(0,l.jsx)(E.OvN,{size:12})," Mosaic"]}),(0,l.jsxs)("button",{className:"plain-effect-btn",onClick:()=>w("sliceShift"),children:[(0,l.jsx)(E.OvN,{size:12})," Slice"]}),(0,l.jsxs)("button",{className:"plain-effect-btn",onClick:()=>w("posterize"),children:[(0,l.jsx)(E.OvN,{size:12})," Posterize"]}),(0,l.jsxs)("button",{className:"plain-effect-btn",onClick:()=>w("findEdges"),children:[(0,l.jsx)(E.OvN,{size:12})," Find Edges"]})]})]})})};function A(e,t,a,l,n,o,i,r){let s="vertical"===r,c=s?a/n.slices:l/n.slices,h=n.slices,d=[];if("rearrange"===n.mode){let e=Array.from({length:h},(e,t)=>t);switch(n.rearrangeMode){case"reverse":d=[...e].reverse();break;case"alternate":d=[...e.filter(e=>e%2==0),...e.filter(e=>e%2==1)];break;case"shuffle":d=[...e];for(let e=d.length-1;e>0;e--){let t=Math.floor(o()*(e+1));[d[e],d[t]]=[d[t],d[e]]}break;default:d=e.map(()=>Math.floor(o()*h))}}for(let r=0;r<h;r++){let m,g,u,f,b,x,p,v;let M=r*c,j=r===h-1?s?a-M:l-M:c;if(j<=0)continue;let y=r,w=0;switch(n.mode){case"random":w=(2*o()-1)*n.maxOffset*i;break;case"alternating":w=(r%2==0?1:-1)*n.maxOffset*i;break;case"wave":w=Math.sin(r/h*Math.PI*6)*n.maxOffset*i;break;case"rearrange":y=d[r];break;case"repeat":if(r%2==1){let e=o()>.5;e&&r>0?y=r-1:!e&&r<h-1&&(y=r+1)}}let C=y*c,k=M+(w=Math.round(w));if(s?(m=C,g=0,u=j,f=l,b=k,x=0,p=j,v=l):(m=0,g=C,u=a,f=j,b=0,x=k,p=a,v=j),n.feathering&&n.featherAmount>0){let a=n.featherAmount/100*c/2;s?function(e,t,a,l,n,o,i,r,s){if(e.drawImage(t,a,l,n,o,i,r,n,o),s<1)return;let c=document.createElement("canvas");c.width=n,c.height=o;let h=c.getContext("2d");if(!h)return;h.drawImage(t,a,l,n,o,0,0,n,o);let d=h.createLinearGradient(0,0,s,0);d.addColorStop(0,"rgba(0,0,0,0)"),d.addColorStop(1,"rgba(0,0,0,1)");let m=h.createLinearGradient(n-s,0,n,0);m.addColorStop(0,"rgba(0,0,0,1)"),m.addColorStop(1,"rgba(0,0,0,0)"),h.globalCompositeOperation="destination-in",a>0&&(h.fillStyle=d,h.fillRect(0,0,s,o)),a+n<t.width&&(h.fillStyle=m,h.fillRect(n-s,0,s,o)),e.drawImage(c,0,0,n,o,i,r,n,o)}(e,t,m,g,u,f,b,x,a):function(e,t,a,l,n,o,i,r,s){if(e.drawImage(t,a,l,n,o,i,r,n,o),s<1)return;let c=document.createElement("canvas");c.width=n,c.height=o;let h=c.getContext("2d");if(!h)return;h.drawImage(t,a,l,n,o,0,0,n,o);let d=h.createLinearGradient(0,0,0,s);d.addColorStop(0,"rgba(0,0,0,0)"),d.addColorStop(1,"rgba(0,0,0,1)");let m=h.createLinearGradient(0,o-s,0,o);m.addColorStop(0,"rgba(0,0,0,1)"),m.addColorStop(1,"rgba(0,0,0,0)"),h.globalCompositeOperation="destination-in",l>0&&(h.fillStyle=d,h.fillRect(0,0,n,s)),l+o<t.height&&(h.fillStyle=m,h.fillRect(0,o-s,n,s)),e.drawImage(c,0,0,n,o,i,r,n,o)}(e,t,m,g,u,f,b,x,a)}else e.drawImage(t,m,g,u,f,b,x,p,v)}}function L(e){let{blur:t,onBlurChange:a}=e,[s,c]=(0,n.useState)(null),[h,d]=(0,n.useState)(null),m=(0,n.useRef)(null),[g,u]=(0,n.useState)(!1),[f,M]=(0,n.useState)(!1),z=(0,n.useRef)(null),[R,O]=(0,n.useState)(800),[L,T]=(0,n.useState)(600),[B,P]=(0,n.useState)("4:3"),[Y,G]=(0,n.useState)("landscape"),[U,X]=(0,n.useState)(!0),[J,q]=(0,n.useState)(!1),[V,H]=(0,n.useState)({enabled:!1,hueShift:0,saturation:100,brightness:100,contrast:100,posterize:0,invert:!1,glitchIntensity:0,glitchSeed:Math.random(),blendMode:"normal"}),[W,_]=(0,n.useState)({enabled:!1,cellSize:8,mix:100,colored:!1,enableCMYK:!1,arrangement:"grid",shape:"circle",angleOffset:0,sizeVariation:0,dotScaleFactor:.8,invertBrightness:!1,spiralTightness:.1,spiralExpansion:1,spiralRotation:0,spiralCenterX:0,spiralCenterY:0,concentricCenterX:0,concentricCenterY:0,concentricRingSpacing:1,channels:{cyan:!0,magenta:!0,yellow:!0,black:!0},cmykAngles:{cyan:15,magenta:75,yellow:0,black:45}}),[K,$]=(0,n.useState)({enabled:!1,columns:3,rows:3,applyRotation:!1,maxRotation:10,splitEnabled:!1,splitProbability:.5,maxSplitLevels:2,minCellSize:50}),[Q,Z]=(0,n.useState)({enabled:!1,type:"floyd-steinberg",threshold:128,colorMode:"grayscale",resolution:30,colorDepth:2,darkColor:"#000000",lightColor:"#FFFFFF"}),[ee,et]=(0,n.useState)({enabled:!1,text:"MATRIX",fontSize:12,fontFamily:"monospace",colorMode:"monochrome",contrast:1,brightness:.5,invert:!1,resolution:2}),[ea,el]=(0,n.useState)({enabled:!1,mode:"solid",threshold:128,darkColor:"#000000",lightColor:"#FFFFFF",darkColorStart:"#000000",darkColorEnd:"#000066",lightColorStart:"#FFFFFF",lightColorEnd:"#FFFF66"}),[en,eo]=(0,n.useState)({enabled:!1,stops:[{position:0,color:"#000000"},{position:50,color:"#ff0000"},{position:100,color:"#ffffff"}],blendMode:"normal",opacity:1}),[ei,er]=(0,n.useState)([]),[es,ec]=(0,n.useState)({}),[eh,ed]=(0,n.useState)({masterEnabled:!1,enabled:!1,glitchIntensity:50,glitchDensity:50,glitchDirection:"horizontal",glitchSize:10,pixelSortingEnabled:!1,pixelSortingThreshold:.5,pixelSortingDirection:"horizontal",channelShiftEnabled:!1,channelShiftAmount:1,channelShiftMode:"rgb",scanLinesEnabled:!1,scanLinesCount:20,scanLinesIntensity:50,scanLinesDirection:"horizontal",noiseEnabled:!1,noiseAmount:20,blocksEnabled:!1,blocksSize:20,blocksOffset:10,blocksDensity:20}),[em,eg]=(0,n.useState)(!1),[eu,ef]=(0,n.useState)(null),eb=n.useRef(null),[ex,ep]=(0,n.useState)({enabled:!1,columns:8,rows:8,maxOffsetX:50,maxOffsetY:50,pattern:"random",intensity:50,seed:1e3*Math.random(),preserveEdges:!0,randomRotation:!1,maxRotation:15,backgroundColor:"#000000",useBackgroundColor:!1}),[ev,eM]=(0,n.useState)({enabled:!1,slices:40,direction:"vertical",maxOffset:20,mode:"random",intensity:50,seed:1e3*Math.random(),feathering:!1,featherAmount:20,rearrangeMode:"random",backgroundColor:"#000000",useBackgroundColor:!1}),[ej,ey]=(0,n.useState)({enabled:!1,levels:2,colorMode:"rgb",preserveLuminance:!0,dithering:!1,ditherAmount:50}),[ew,eC]=(0,n.useState)({enabled:!1,algorithm:"sobel",intensity:50,threshold:128,invert:!1,colorMode:"grayscale",blurRadius:0}),ek=async e=>{var t;let a=null===(t=e.target.files)||void 0===t?void 0:t[0];if(a)try{let e=await a.text(),t=JSON.parse(e);eL(t)}catch(e){alert("Error loading settings: "+e.message)}},eN=e=>{if(e&&e.length>0){let t=e[0],a=new FileReader;a.onload=e=>{var t;if(null===(t=e.target)||void 0===t?void 0:t.result){let t=e.target.result;c(t),d(t);let a=new Image;a.onload=()=>{let e=window.innerWidth-80,t=window.innerHeight-200,l=a.width,n=a.height;if(l>e){let t=e/l;l=e,n*=t}if(n>t){let e=t/n;n=t,l*=e}O(Math.round(l)),T(Math.round(n)),P("custom")},a.src=t}},a.readAsDataURL(t)}},{getRootProps:eS,getInputProps:eI,isDragActive:ez}=(0,o.uI)({onDrop:eN,accept:{"image/*":[".jpeg",".jpg",".png",".gif",".webp"]},maxFiles:1});(0,n.useEffect)(()=>{if(!U||"custom"===B)return;let e=1;switch(B){case"1:1":e=1;break;case"4:3":e=4/3;break;case"16:9":e=16/9;break;case"3:2":e=1.5;break;case"5:4":e=5/4;break;case"2:1":e=2;break;case"3:4":e=3/4;break;case"9:16":e=9/16;break;case"2:3":e=2/3;break;case"4:5":e=.8;break;case"1:2":e=.5;break;default:e=R/L}"landscape"===Y?T(Math.round(R/e)):O(Math.round(L*e))},[B,Y,U]);let eD=(0,n.useCallback)(()=>{M(!0),fetch("https://picsum.photos/800").then(e=>e.blob()).then(e=>new Promise(t=>{let a=new FileReader;a.onload=e=>{var a;let l=null===(a=e.target)||void 0===a?void 0:a.result;if(!l)throw Error("Failed to load image data");c(l),d(l);let n=new Image;n.onload=()=>{t({width:n.width,height:n.height})},n.src=l},a.readAsDataURL(e)})).then(e=>{let{width:t,height:a}=e;O(t),T(a),P("custom")}).catch(e=>{}).finally(()=>{M(!1)})},[O,T,P,c,d,M]),eE=()=>{H({enabled:!1,hueShift:0,saturation:100,brightness:100,contrast:100,posterize:0,invert:!1,glitchIntensity:0,glitchSeed:Math.random(),blendMode:"normal"}),eo({enabled:!1,stops:[{position:0,color:"#000000"},{position:50,color:"#808080"},{position:100,color:"#ffffff"}],blendMode:"normal",opacity:1}),el({enabled:!1,mode:"solid",threshold:128,darkColor:"#000000",lightColor:"#ffffff",darkColorStart:"#000000",darkColorEnd:"#404040",lightColorStart:"#BFBFBF",lightColorEnd:"#ffffff"}),_({enabled:!1,cellSize:8,mix:100,colored:!1,enableCMYK:!1,arrangement:"grid",shape:"circle",angleOffset:45,sizeVariation:0,dotScaleFactor:1,invertBrightness:!1,spiralTightness:.1,spiralExpansion:1,spiralRotation:0,spiralCenterX:0,spiralCenterY:0,concentricCenterX:0,concentricCenterY:0,concentricRingSpacing:1,channels:{cyan:!0,magenta:!0,yellow:!0,black:!0},cmykAngles:{cyan:15,magenta:75,yellow:0,black:45}}),Z({enabled:!1,type:"floyd-steinberg",threshold:128,colorMode:"grayscale",resolution:8,colorDepth:2,darkColor:"#000000",lightColor:"#ffffff"}),et({enabled:!1,text:"Hello",fontSize:12,fontFamily:"monospace",colorMode:"monochrome",contrast:1,brightness:.5,invert:!1,resolution:2}),ed({masterEnabled:!1,enabled:!1,glitchIntensity:10,glitchDensity:10,glitchDirection:"horizontal",glitchSize:20,pixelSortingEnabled:!1,pixelSortingThreshold:50,pixelSortingDirection:"horizontal",channelShiftEnabled:!1,channelShiftAmount:5,channelShiftMode:"rgb",scanLinesEnabled:!1,scanLinesCount:50,scanLinesIntensity:.5,scanLinesDirection:"horizontal",noiseEnabled:!1,noiseAmount:.5,blocksEnabled:!1,blocksSize:20,blocksOffset:0,blocksDensity:.3}),ep({enabled:!1,columns:8,rows:8,maxOffsetX:50,maxOffsetY:50,pattern:"random",intensity:50,seed:1e3*Math.random(),preserveEdges:!0,randomRotation:!1,maxRotation:15,backgroundColor:"#000000",useBackgroundColor:!1}),eM({enabled:!1,slices:40,direction:"vertical",maxOffset:20,mode:"random",intensity:50,seed:1e3*Math.random(),feathering:!1,featherAmount:20,rearrangeMode:"random",backgroundColor:"#000000",useBackgroundColor:!1}),ey({enabled:!1,levels:2,colorMode:"rgb",preserveLuminance:!0,dithering:!1,ditherAmount:50}),eC({enabled:!1,algorithm:"sobel",intensity:50,threshold:128,invert:!1,colorMode:"grayscale",blurRadius:0}),eF()},eR=e=>{let t=ei.filter(t=>t.type===e).reduce((e,t)=>{let a=parseInt(t.id.split("-")[1]);return a>e?a:e},0);return"".concat(e,"-").concat(t+1)},eO=e=>{if(es[e.id])return es[e.id];switch(e.type){case"color":return V;case"gradient":return en;case"threshold":return ea;case"halftone":return W;case"grid":return K;case"dither":return Q;case"textDither":return ee;case"glitch":return eh;case"blur":return t;case"mosaicShift":return ex;case"sliceShift":return ev;default:return{}}},eF=(0,n.useCallback)(()=>{if(!s||!m.current||!z.current)return;u(!0);let e=m.current,t=e.getContext("2d"),a=z.current,l=a.getContext("2d");if(!t||!l){u(!1);return}e.width=R,e.height=L,a.width=R,a.height=L;let n=new Image;n.onload=()=>{t.clearRect(0,0,R,L),l.clearRect(0,0,R,L),l.drawImage(n,0,0,R,L),ei.forEach(e=>{if(!e.enabled)return;let t=eO(e);switch(e.type){case"color":t.enabled&&function(e,t,a,l){if(!l.enabled)return;let n=e.getImageData(0,0,t,a),{data:o}=n;for(let e=0;e<o.length;e+=4){let t=o[e],a=o[e+1],n=o[e+2],{h:i,s:r,l:s}=function(e,t,a){let l=Math.max(e/=255,t/=255,a/=255),n=Math.min(e,t,a),o=0,i=0,r=(l+n)/2;if(l!==n){let s=l-n;switch(i=r>.5?s/(2-l-n):s/(l+n),l){case e:o=(t-a)/s+(t<a?6:0);break;case t:o=(a-e)/s+2;break;case a:o=(e-t)/s+4}o/=6}return{h:Math.round(360*o),s:Math.round(100*i),l:Math.round(100*r)}}(t,a,n);(i=(i+l.hueShift)%360)<0&&(i+=360);let c=function(e,t,a){let l,n,o;if(e/=360,a/=100,0==(t/=100))l=n=o=a;else{let i=(e,t,a)=>(a<0&&(a+=1),a>1&&(a-=1),a<1/6)?e+(t-e)*6*a:a<.5?t:a<2/3?e+(t-e)*(2/3-a)*6:e,r=a<.5?a*(1+t):a+t-a*t,s=2*a-r;l=i(s,r,e+1/3),n=i(s,r,e),o=i(s,r,e-1/3)}return{r:Math.round(255*l),g:Math.round(255*n),b:Math.round(255*o)}}(i,r=Math.min(100,Math.max(0,l.saturation/100*r)),s=Math.min(100,Math.max(0,l.brightness/100*s)));t=c.r,a=c.g,n=c.b;let h=259*(l.contrast+255)/(255*(259-l.contrast));if(t=Math.min(255,Math.max(0,Math.round(h*(t-128)+128))),a=Math.min(255,Math.max(0,Math.round(h*(a-128)+128))),n=Math.min(255,Math.max(0,Math.round(h*(n-128)+128))),l.posterize>0){let e=255/(Math.max(2,Math.min(32,Math.round(l.posterize)))-1);t=Math.round(Math.round(t/e)*e),a=Math.round(Math.round(a/e)*e),n=Math.round(Math.round(n/e)*e)}if(l.invert&&(t=255-t,a=255-a,n=255-n),l.glitchIntensity>0){let i=l.glitchIntensity/100;if(l.glitchSeed,Math.random()<.3*i){let a=(e+4*Math.floor(20*Math.random()*i))%o.length;t=o[a]||t}if(Math.random()<.3*i){let t=(e+4*Math.floor(20*Math.random()*i)+1)%o.length;a=o[t]||a}if(Math.random()<.3*i){let t=(e+4*Math.floor(20*Math.random()*i)+2)%o.length;n=o[t]||n}}o[e]=t,o[e+1]=a,o[e+2]=n}e.putImageData(n,0,0)}(l,R,L,{enabled:!0,hueShift:Number(t.hueShift)||0,saturation:Number(t.saturation)||100,brightness:Number(t.brightness)||100,contrast:Number(t.contrast)||100,posterize:Number(t.posterize)||0,invert:!!t.invert,glitchIntensity:Number(t.glitchIntensity)||0,glitchSeed:Number(t.glitchSeed)||Math.random(),blendMode:t.blendMode||"normal"});break;case"gradient":!function(e,t,a,l,n){if(!n.enabled||n.stops.length<2||!t.getContext("2d"))return;let o=document.createElement("canvas");o.width=a,o.height=l;let i=o.getContext("2d");if(!i)return;i.drawImage(t,0,0);let r=i.getImageData(0,0,a,l),{data:s}=r,c=[...n.stops].sort((e,t)=>e.position-t.position);for(let e=0;e<s.length;e+=4){let t=function(e,t){if(0===t.length)return[0,0,0];if(1===t.length)return N(t[0].color);let a=t[0],l=t[t.length-1];for(let n=0;n<t.length-1;n++)if(e>=t[n].position&&e<=t[n+1].position){a=t[n],l=t[n+1];break}if(e<a.position)return N(a.color);if(e>l.position)return N(l.color);let n=l.position-a.position;if(0===n)return N(a.color);let o=(e-a.position)/n,i=N(a.color),r=N(l.color);return[Math.round(i[0]+o*(r[0]-i[0])),Math.round(i[1]+o*(r[1]-i[1])),Math.round(i[2]+o*(r[2]-i[2]))]}((.299*s[e]+.587*s[e+1]+.114*s[e+2])/255*100,c);(function(e,t,a,l,n,o,i){let r=e[t],s=e[t+1],c=e[t+2],h=[r,s,c];switch(o){case"normal":h=[a,l,n];break;case"multiply":h=[r*a/255,s*l/255,c*n/255];break;case"screen":h=[255-(255-r)*(255-a)/255,255-(255-s)*(255-l)/255,255-(255-c)*(255-n)/255];break;case"overlay":h=[r<128?2*r*a/255:255-2*(255-r)*(255-a)/255,s<128?2*s*l/255:255-2*(255-s)*(255-l)/255,c<128?2*c*n/255:255-2*(255-c)*(255-n)/255];break;case"hard-light":h=[a<128?2*a*r/255:255-2*(255-a)*(255-r)/255,l<128?2*l*s/255:255-2*(255-l)*(255-s)/255,n<128?2*n*c/255:255-2*(255-n)*(255-c)/255];break;case"soft-light":h=[(255-r)*r*a/65025+r*(255-(255-r)*(255-a)/255)/255,(255-s)*s*l/65025+s*(255-(255-s)*(255-l)/255)/255,(255-c)*c*n/65025+c*(255-(255-c)*(255-n)/255)/255];break;case"color":let d=S(r,s,c),m=S(a,l,n);h=I(m[0],m[1],d[2]);break;case"luminosity":let g=S(r,s,c),u=S(a,l,n);h=I(g[0],g[1],u[2])}h=[Math.round(r+(h[0]-r)*i),Math.round(s+(h[1]-s)*i),Math.round(c+(h[2]-c)*i)],e[t]=h[0],e[t+1]=h[1],e[t+2]=h[2]})(s,e,t[0],t[1],t[2],n.blendMode,n.opacity)}i.putImageData(r,0,0),e.clearRect(0,0,a,l),e.drawImage(o,0,0)}(l,a,R,L,{...JSON.parse(JSON.stringify(t)),enabled:!0});break;case"threshold":!function(e,t,a,l){if(!l.enabled)return;let n=e.getImageData(0,0,t,a),{data:o}=n;for(let e=0;e<a;e++){let n=e/a;for(let a=0;a<t;a++){let i;let r=(e*t+a)*4,s=.299*o[r]+.587*o[r+1]+.114*o[r+2]<l.threshold;if("solid"===l.mode)i=w(s?l.darkColor:l.lightColor);else{let e=C(l.darkColorStart,l.darkColorEnd,n),t=C(l.lightColorStart,l.lightColorEnd,n);i=w(s?e:t)}o[r]=i.r,o[r+1]=i.g,o[r+2]=i.b}}e.putImageData(n,0,0)}(l,R,L,{...JSON.parse(JSON.stringify(t)),enabled:!0});break;case"halftone":!function(e,t,a,l,n){if(!n.enabled)return;let o=t.getContext("2d");if(!o)return;let s=o.getImageData(0,0,a,l).data;e.clearRect(0,0,a,l),e.fillStyle="#ffffff",e.fillRect(0,0,a,l);let c=Math.max(1,n.cellSize),h=Math.ceil(a/c),d=Math.ceil(l/c),m=[];if(n.enableCMYK&&(n.channels.cyan||n.channels.magenta||n.channels.yellow||n.channels.black)){(function(e,t,a,l,n,o,i,s,c){let h=(e,t,a)=>{let l=1-Math.max(e/=255,t/=255,a/=255);return{c:1===l?0:(1-e-l)/(1-l),m:1===l?0:(1-t-l)/(1-l),y:1===l?0:(1-a-l)/(1-l),k:l}};function d(d,m){e.globalCompositeOperation="multiply";for(let g=0;g<o;g++)for(let o=0;o<n;o++){let n=o*i+i/2,u=g*i+i/2,f=n,b=u;if("hexagonal"===s.arrangement&&g%2==0)f+=i/2;else if("spiral"===s.arrangement){let e=a/2+s.spiralCenterX,t=l/2+s.spiralCenterY,o=n-e,i=u-t,r=Math.sqrt(o*o+i*i),c=Math.atan2(i,o)+s.spiralRotation*(Math.PI/180)+r*(.001+.009*s.spiralTightness)*(s.spiralExpansion||1);f=e+Math.cos(c)*r,b=t+Math.sin(c)*r;let h=Math.sqrt(a*a+l*l)/2,d=h/(.8*h);f=e+(f-e)*d,b=t+(b-t)*d}else if("concentric"===s.arrangement){let e=a/2+s.concentricCenterX,t=l/2+s.concentricCenterY,o=n-e,r=u-t,c=Math.sqrt(o*o+r*r),h=Math.atan2(r,o),d=i*(s.concentricRingSpacing||1),m=Math.floor(c/d)*d;f=e+Math.cos(h)*m,b=t+Math.sin(h)*m}else"random"===s.arrangement&&(f=n+(Math.random()-.5)*i/2,b=u+(Math.random()-.5)*i/2);let x=Math.min(a-1,Math.max(0,Math.floor(f))),p=(Math.min(l-1,Math.max(0,Math.floor(b)))*a+x)*4,v=h(t[p],t[p+1],t[p+2])[d];s.invertBrightness&&(v=1-v);let M=1+(Math.random()-.5)*s.sizeVariation,j=i*s.dotScaleFactor*M*v;if(j<.5)continue;r(e,f,b,j,s.shape,m+s.angleOffset);let y="c"===d?"cyan":"m"===d?"magenta":"y"===d?"yellow":"black";c.push({x:f,y:b,size:j,color:y})}e.globalCompositeOperation="source-over"}s.channels.cyan&&(e.fillStyle="cyan",d("c",s.cmykAngles.cyan)),s.channels.magenta&&(e.fillStyle="magenta",d("m",s.cmykAngles.magenta)),s.channels.yellow&&(e.fillStyle="yellow",d("y",s.cmykAngles.yellow)),s.channels.black&&(e.fillStyle="black",d("k",s.cmykAngles.black))})(e,s,a,l,h,d,c,n,m),n.mix<100&&(e.globalAlpha=1-n.mix/100,e.drawImage(t,0,0),e.globalAlpha=1),i.updateDots(m,a,l,n);return}for(let t=0;t<d;t++)for(let o=0;o<h;o++){let i=o*c+c/2,h=t*c+c/2,d=i,g=h;if("hexagonal"===n.arrangement&&t%2==0)d+=c/2;else if("spiral"===n.arrangement){let e=a/2+n.spiralCenterX,t=l/2+n.spiralCenterY,o=i-e,r=h-t,s=Math.sqrt(o*o+r*r),c=Math.atan2(r,o)+n.spiralRotation*(Math.PI/180)+s*(.001+.009*n.spiralTightness)*(n.spiralExpansion||1);d=e+Math.cos(c)*s,g=t+Math.sin(c)*s;let m=Math.sqrt(a*a+l*l)/2,u=m/(.8*m);d=e+(d-e)*u,g=t+(g-t)*u}else if("concentric"===n.arrangement){let e=a/2+n.concentricCenterX,t=l/2+n.concentricCenterY,o=i-e,r=h-t,s=Math.sqrt(o*o+r*r),m=Math.atan2(r,o),u=c*(n.concentricRingSpacing||1),f=Math.floor(s/u)*u;d=e+Math.cos(m)*f,g=t+Math.sin(m)*f}else"random"===n.arrangement&&(d=i+(Math.random()-.5)*c/2,g=h+(Math.random()-.5)*c/2);let u=Math.min(a-1,Math.max(0,Math.floor(d))),f=(Math.min(l-1,Math.max(0,Math.floor(g)))*a+u)*4,b=s[f],x=s[f+1],p=s[f+2],v=(.299*b+.587*x+.114*p)/255;n.invertBrightness||(v=1-v);let M=1+(Math.random()-.5)*n.sizeVariation,j=c*n.dotScaleFactor*M*v;j<.5||(n.colored?(e.fillStyle="rgb(".concat(b,", ").concat(x,", ").concat(p,")"),e.strokeStyle="rgb(".concat(b,", ").concat(x,", ").concat(p,")")):(e.fillStyle="#000000",e.strokeStyle="#000000"),r(e,d,g,j,n.shape,n.angleOffset),m.push({x:d,y:g,size:j,color:n.colored?"rgb(".concat(b,",").concat(x,",").concat(p,")"):void 0}))}i.updateDots(m,a,l,n),n.mix<100&&(e.globalAlpha=1-n.mix/100,e.drawImage(t,0,0),e.globalAlpha=1)}(l,a,R,L,{...JSON.parse(JSON.stringify(t)),enabled:!0});break;case"grid":let n={...JSON.parse(JSON.stringify(t)),enabled:!0};(function(e,t,a){if(!a.enabled)return[];let{columns:l,rows:n}=a,o=e/l,i=t/n,r=[];for(let e=0;e<n;e++)for(let t=0;t<l;t++){let l={x:t*o,y:e*i,width:o,height:i,rotation:a.applyRotation?(Math.random()-.5)*a.maxRotation:0,children:[]};a.splitEnabled&&function e(t,a,l,n,o,i,r){if(!(r>=l||t.width<2*n||t.height<2*n||Math.random()>(l-r+1)/l*a)){if(.5>Math.random()){let s=t.height*(.3+.4*Math.random()),c=t.height-s,h={x:t.x,y:t.y,width:t.width,height:s,rotation:o?(Math.random()-.5)*i:0,children:[]},d={x:t.x,y:t.y+s,width:t.width,height:c,rotation:o?(Math.random()-.5)*i:0,children:[]};t.children.push(h,d),e(h,a,l,n,o,i,r+1),e(d,a,l,n,o,i,r+1)}else{let s=t.width*(.3+.4*Math.random()),c=t.width-s,h={x:t.x,y:t.y,width:s,height:t.height,rotation:o?(Math.random()-.5)*i:0,children:[]},d={x:t.x+s,y:t.y,width:c,height:t.height,rotation:o?(Math.random()-.5)*i:0,children:[]};t.children.push(h,d),e(h,a,l,n,o,i,r+1),e(d,a,l,n,o,i,r+1)}}}(l,a.splitProbability,a.maxSplitLevels,a.minCellSize,a.applyRotation,a.maxRotation,1),r.push(l)}return r})(R,L,n).forEach(e=>(function e(t,a,l,n){if(t.save(),0!==a.rotation){let e=a.x+a.width/2,l=a.y+a.height/2;t.translate(e,l),t.rotate(a.rotation*Math.PI/180),t.translate(-e,-l)}if(t.drawImage(l,a.x,a.y,a.width,a.height,a.x,a.y,a.width,a.height),a.children.length>0)for(let o of(t.clearRect(a.x,a.y,a.width,a.height),a.children))e(t,o,l,n);t.restore()})(l,e,a,n));break;case"dither":!function(e,t,a,l,n){if(!n.enabled||!t.getContext("2d"))return;let o=n.resolution/100,i=Math.max(1,Math.floor(a*o)),r=Math.max(1,Math.floor(l*o)),s=document.createElement("canvas");s.width=i,s.height=r;let c=s.getContext("2d");if(!c)return;c.imageSmoothingEnabled=!1,c.drawImage(t,0,0,i,r);let h=c.getImageData(0,0,i,r),d=[];"ordered"===n.type?function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],{width:l,height:n,data:o}=e,i=Math.max(2,Math.min(256,t.colorDepth)),r=t.threshold/255,s="color"===t.colorMode?p(e,i):null,c=[0,0,0],h=[255,255,255];"2-color"===t.colorMode&&(c=v(t.darkColor)||c,h=v(t.lightColor)||h);for(let d=0;d<n;d++)for(let n=0;n<l;n++){let m=(d*l+n)*4;if("grayscale"===t.colorMode){let t=.299*o[m]+.587*o[m+1]+.114*o[m+2],s=255/(i-1)*Math.round((t<255*r?0:t)/(255/(i-1)));if(o[m]=s,o[m+1]=s,o[m+2]=s,s<255){let t=Math.max(1,Math.ceil(l/e.width)),o="rgb(".concat(s,", ").concat(s,", ").concat(s,")");a.push({x:n*t,y:d*t,size:t,color:o})}}else if("2-color"===t.colorMode){if(.299*o[m]+.587*o[m+1]+.114*o[m+2]<255*r){o[m]=c[0],o[m+1]=c[1],o[m+2]=c[2];let t=Math.max(1,Math.ceil(l/e.width)),i="rgb(".concat(c[0],", ").concat(c[1],", ").concat(c[2],")");a.push({x:n*t,y:d*t,size:t,color:i})}else if(o[m]=h[0],o[m+1]=h[1],o[m+2]=h[2],h[0]<255||h[1]<255||h[2]<255){let t=Math.max(1,Math.ceil(l/e.width)),o="rgb(".concat(h[0],", ").concat(h[1],", ").concat(h[2],")");a.push({x:n*t,y:d*t,size:t,color:o})}}else if(s){let t=o[m],i=o[m+1],c=o[m+2];if((t+i+c)/3<255*r){o[m]=0,o[m+1]=0,o[m+2]=0;let t=Math.max(1,Math.ceil(l/e.width));a.push({x:n*t,y:d*t,size:t,color:"rgb(0, 0, 0)"});continue}let h=s[0],g=1/0;for(let e of s){let a=Math.sqrt(Math.pow(t-e[0],2)+Math.pow(i-e[1],2)+Math.pow(c-e[2],2));a<g&&(g=a,h=e)}if(o[m]=h[0],o[m+1]=h[1],o[m+2]=h[2],h[0]<255||h[1]<255||h[2]<255){let t=Math.max(1,Math.ceil(l/e.width)),o="rgb(".concat(h[0],", ").concat(h[1],", ").concat(h[2],")");a.push({x:n*t,y:d*t,size:t,color:o})}}}}(h,n,d):function(e,t){var a,l;let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],{width:o,height:i,data:r}=e,s=Math.max(2,Math.min(256,t.colorDepth)),c=t.threshold/255,h="ordered"===t.type?null:x[t.type],d=null!==(a=null==h?void 0:h.width)&&void 0!==a?a:0,m=null!==(l=null==h?void 0:h.height)&&void 0!==l?l:0,g="color"===t.colorMode?p(e,s):null,u=[0,0,0],f=[255,255,255];"2-color"===t.colorMode&&(u=v(t.darkColor)||u,f=v(t.lightColor)||f);let b=new Uint8ClampedArray(r);for(let a=0;a<i;a++)for(let l=0;l<o;l++){let x=(a*o+l)*4;if("grayscale"===t.colorMode){let t=.299*b[x]+.587*b[x+1]+.114*b[x+2],g=255/(s-1)*Math.round((t<255*c?0:t)/(255/(s-1))),u=t-g;if(r[x]=g,r[x+1]=g,r[x+2]=g,g<255){let t=Math.max(1,Math.ceil(o/e.width)),i="rgb(".concat(g,", ").concat(g,", ").concat(g,")");n.push({x:l*t,y:a*t,size:t,color:i})}if(h)for(let e=0;e<m;e++)for(let t=-Math.floor(d/2);t<=Math.floor(d/2);t++){if(0===e&&t<=0)continue;let n=l+t,r=a+e;if(n>=0&&n<o&&r<i){let a=(r*o+n)*4,l=h.matrix[e][t+Math.floor(d/2)];b[a]=Math.min(255,Math.max(0,b[a]+u*l)),b[a+1]=Math.min(255,Math.max(0,b[a+1]+u*l)),b[a+2]=Math.min(255,Math.max(0,b[a+2]+u*l))}}}else if("2-color"===t.colorMode){let t,s,g,p;let v=.299*b[x]+.587*b[x+1]+.114*b[x+2];if(v<255*c){s=u[0],g=u[1],p=u[2],t=0;let i=Math.max(1,Math.ceil(o/e.width)),r="rgb(".concat(s,", ").concat(g,", ").concat(p,")");n.push({x:l*i,y:a*i,size:i,color:r})}else if(s=f[0],g=f[1],p=f[2],t=255,f[0]<255||f[1]<255||f[2]<255){let t=Math.max(1,Math.ceil(o/e.width)),i="rgb(".concat(f[0],", ").concat(f[1],", ").concat(f[2],")");n.push({x:l*t,y:a*t,size:t,color:i})}r[x]=s,r[x+1]=g,r[x+2]=p;let M=v-t;if(h)for(let e=0;e<m;e++)for(let t=-Math.floor(d/2);t<=Math.floor(d/2);t++){if(0===e&&t<=0)continue;let n=l+t,r=a+e;if(n>=0&&n<o&&r<i){let a=(r*o+n)*4,l=M*h.matrix[e][t+Math.floor(d/2)];b[a]=Math.min(255,Math.max(0,b[a]+l)),b[a+1]=Math.min(255,Math.max(0,b[a+1]+l)),b[a+2]=Math.min(255,Math.max(0,b[a+2]+l))}}}else if(g){let t=b[x],s=b[x+1],u=b[x+2];if((t+s+u)/3<255*c){r[x]=0,r[x+1]=0,r[x+2]=0;let t=Math.max(1,Math.ceil(o/e.width));n.push({x:l*t,y:a*t,size:t,color:"rgb(0, 0, 0)"});continue}let f=g[0],p=1/0;for(let e of g){let a=Math.sqrt(Math.pow(t-e[0],2)+Math.pow(s-e[1],2)+Math.pow(u-e[2],2));a<p&&(p=a,f=e)}if(r[x]=f[0],r[x+1]=f[1],r[x+2]=f[2],f[0]<255||f[1]<255||f[2]<255){let t=Math.max(1,Math.ceil(o/e.width)),i="rgb(".concat(f[0],", ").concat(f[1],", ").concat(f[2],")");n.push({x:l*t,y:a*t,size:t,color:i})}let v=t-f[0],M=s-f[1],j=u-f[2];if(h)for(let e=0;e<m;e++)for(let t=-Math.floor(d/2);t<=Math.floor(d/2);t++){if(0===e&&t<=0)continue;let n=l+t,r=a+e;if(n>=0&&n<o&&r<i){let a=(r*o+n)*4,l=h.matrix[e][t+Math.floor(d/2)];b[a]=Math.min(255,Math.max(0,b[a]+v*l)),b[a+1]=Math.min(255,Math.max(0,b[a+1]+M*l)),b[a+2]=Math.min(255,Math.max(0,b[a+2]+j*l))}}}}}(h,n,d),b.updateDots(d,a,l,n),c.putImageData(h,0,0),e.clearRect(0,0,a,l),e.imageSmoothingEnabled=!1,e.drawImage(s,0,0,a,l)}(l,a,R,L,{...JSON.parse(JSON.stringify(t)),enabled:!0});break;case"textDither":!function(e,t,a,l){if(!l.enabled)return;let n=e.getImageData(0,0,t,a).data,o=document.createElement("canvas");o.width=t,o.height=a;let i=o.getContext("2d");if(!i)return;i.clearRect(0,0,t,a),i.font="".concat(l.fontSize,"px ").concat(l.fontFamily),i.textAlign="center",i.textBaseline="middle";let r=(l.text||"MATRIX").split(""),s=r.length,c=Math.floor(t*a/Math.max(1,Math.floor(l.fontSize*l.fontSize/l.resolution)));for(let e=0;e<c;e++){let o=Math.floor(Math.random()*t),c=Math.floor(Math.random()*a),h=(c*t+o)*4,d=Math.round((n[h]+n[h+1]+n[h+2])/3);1!==l.contrast&&(d=259*(100*l.contrast+255)/(255*(259-100*l.contrast))*(d-128)+128),d*=l.brightness,d=Math.max(0,Math.min(255,d)),l.invert&&(d=255-d);let m=r[e%s];if("colored"===l.colorMode){let e=n[h],t=n[h+1],a=n[h+2];if(1!==l.contrast){let n=259*(100*l.contrast+255)/(255*(259-100*l.contrast));e=n*(e-128)+128,t=n*(t-128)+128,a=n*(a-128)+128}e*=l.brightness,t*=l.brightness,a*=l.brightness,e=Math.max(0,Math.min(255,e)),t=Math.max(0,Math.min(255,t)),a=Math.max(0,Math.min(255,a)),l.invert&&(e=255-e,t=255-t,a=255-a),i.fillStyle="rgb(".concat(e,", ").concat(t,", ").concat(a,")")}else i.fillStyle=d>128?"white":"black";i.fillText(m,o,c)}e.clearRect(0,0,t,a),e.drawImage(o,0,0)}(l,R,L,{...JSON.parse(JSON.stringify(t)),enabled:!0});break;case"glitch":!function(e,t,a,l,n){if(!n.masterEnabled||!(n.enabled||n.pixelSortingEnabled||n.channelShiftEnabled||n.scanLinesEnabled||n.noiseEnabled||n.blocksEnabled))return;let o=document.createElement("canvas");o.width=a,o.height=l;let i=o.getContext("2d");i&&(i.clearRect(0,0,a,l),i.drawImage(t,0,0),n.enabled&&function(e,t,a,l){if(!l.enabled)return;let n=l.glitchIntensity/100;if(n<=0)return;let o=e.getImageData(0,0,t,a),i=o.data,r=Math.max(.01,Math.min(1,l.glitchDensity/100));if("horizontal"===l.glitchDirection||"both"===l.glitchDirection){let e=Math.max(1,Math.floor(a*n*r*.5));for(let n=0;n<e;n++){let e=Math.floor(Math.random()*a),n=Math.max(1,Math.floor(l.glitchSize*Math.random())),o=Math.floor(Math.random()*t*(l.glitchSize/100));for(let l=0;l<n;l++){if(e+l>=a)continue;let n=[];for(let a=0;a<t;a++){let o=((e+l)*t+a)*4;n.push([i[o],i[o+1],i[o+2],i[o+3]])}for(let a=0;a<t;a++){let r=n[(a+o)%t],s=((e+l)*t+a)*4;i[s]=r[0],i[s+1]=r[1],i[s+2]=r[2],i[s+3]=r[3]}}}}if("vertical"===l.glitchDirection||"both"===l.glitchDirection){let e=Math.max(1,Math.floor(t*n*r*.5));for(let n=0;n<e;n++){let e=Math.floor(Math.random()*t),n=Math.max(1,Math.floor(l.glitchSize*Math.random())),o=Math.floor(Math.random()*a*(l.glitchSize/100));for(let l=0;l<n;l++){if(e+l>=t)continue;let n=[];for(let o=0;o<a;o++){let a=(o*t+(e+l))*4;n.push([i[a],i[a+1],i[a+2],i[a+3]])}for(let r=0;r<a;r++){let s=n[(r+o)%a],c=(r*t+(e+l))*4;i[c]=s[0],i[c+1]=s[1],i[c+2]=s[2],i[c+3]=s[3]}}}}if(n>.2){let e=Math.max(1,Math.floor(t*a*.001*n*r));for(let n=0;n<e;n++){let e=Math.floor(Math.random()*t),n=Math.floor(Math.random()*a),o=Math.min(Math.floor(3*l.glitchSize*Math.random())+5,t-e),r=Math.min(Math.floor(3*l.glitchSize*Math.random())+5,a-n),s=Math.floor(3*Math.random()),c=Math.floor(100*Math.random())-50;for(let a=0;a<r;a++)for(let l=0;l<o;l++){let o=((n+a)*t+(e+l))*4;i[o+s]=Math.max(0,Math.min(255,i[o+s]+c))}}}e.putImageData(o,0,0)}(i,a,l,n),n.pixelSortingEnabled&&function(e,t,a,l){let n=e.getImageData(0,0,t,a),o=n.data,i=l.pixelSortingThreshold,r=(e,t,a)=>(.299*e+.587*t+.114*a)/255;if("horizontal"===l.pixelSortingDirection||"both"===l.pixelSortingDirection)for(let e=0;e<a;e++){let a=-1;for(let l=0;l<t;l++){let n=(e*t+l)*4,s=r(o[n],o[n+1],o[n+2]);if(s>i&&-1===a)a=l;else if((s<=i||l===t-1)&&-1!==a){if(l-a>1){let n=[];for(let i=a;i<l;i++){let a=(e*t+i)*4;n.push({r:o[a],g:o[a+1],b:o[a+2],a:o[a+3],brightness:r(o[a],o[a+1],o[a+2])})}n.sort((e,t)=>e.brightness-t.brightness);for(let l=0;l<n.length;l++){let i=(e*t+(a+l))*4,r=n[l];o[i]=r.r,o[i+1]=r.g,o[i+2]=r.b,o[i+3]=r.a}}a=-1}}}if("vertical"===l.pixelSortingDirection||"both"===l.pixelSortingDirection)for(let e=0;e<t;e++){let l=-1;for(let n=0;n<a;n++){let s=(n*t+e)*4,c=r(o[s],o[s+1],o[s+2]);if(c>i&&-1===l)l=n;else if((c<=i||n===a-1)&&-1!==l){if(n-l>1){let a=[];for(let i=l;i<n;i++){let l=(i*t+e)*4;a.push({r:o[l],g:o[l+1],b:o[l+2],a:o[l+3],brightness:r(o[l],o[l+1],o[l+2])})}a.sort((e,t)=>e.brightness-t.brightness);for(let n=0;n<a.length;n++){let i=((l+n)*t+e)*4,r=a[n];o[i]=r.r,o[i+1]=r.g,o[i+2]=r.b,o[i+3]=r.a}}l=-1}}}e.putImageData(n,0,0)}(i,a,l,n),n.channelShiftEnabled&&function(e,t,a,l){let n=Math.round(l.channelShiftAmount*t/100);if(0===n)return;let o=e.getImageData(0,0,t,a),i=o.data,r=e.createImageData(t,a).data;for(let e=0;e<i.length;e++)r[e]=i[e];let s="rgb"===l.channelShiftMode||"rb"===l.channelShiftMode||"rg"===l.channelShiftMode,c="rgb"===l.channelShiftMode||"rg"===l.channelShiftMode||"gb"===l.channelShiftMode,h="rgb"===l.channelShiftMode||"rb"===l.channelShiftMode||"gb"===l.channelShiftMode;if(s)for(let e=0;e<a;e++)for(let a=0;a<t;a++){let l=(a-n+t)%t,o=(e*t+l)*4;i[(e*t+a)*4]=r[o]}if(c)for(let e=0;e<a;e++)for(let l=0;l<t;l++){let o=((e-n+a)%a*t+l)*4;i[(e*t+l)*4+1]=r[o+1]}if(h)for(let e=0;e<a;e++)for(let a=0;a<t;a++){let l=(a+n)%t,o=(e*t+l)*4;i[(e*t+a)*4+2]=r[o+2]}e.putImageData(o,0,0)}(i,a,l,n),n.scanLinesEnabled&&function(e,t,a,l){let n=l.scanLinesCount,o=l.scanLinesIntensity/100;if(n<=0||o<=0)return;let i=e.getImageData(0,0,t,a),r=i.data;if("horizontal"===l.scanLinesDirection||"both"===l.scanLinesDirection){let e=Math.floor(a/n);for(let l=0;l<a;l++)if(l%e<e/2)for(let e=0;e<t;e++){let a=(l*t+e)*4;r[a]=r[a]*(1-o),r[a+1]=r[a+1]*(1-o),r[a+2]=r[a+2]*(1-o)}}if("vertical"===l.scanLinesDirection||"both"===l.scanLinesDirection){let e=Math.floor(t/n);for(let l=0;l<t;l++)if(l%e<e/2)for(let e=0;e<a;e++){let a=(e*t+l)*4;r[a]=r[a]*(1-o),r[a+1]=r[a+1]*(1-o),r[a+2]=r[a+2]*(1-o)}}e.putImageData(i,0,0)}(i,a,l,n),n.noiseEnabled&&function(e,t,a,l){let n=l.noiseAmount/100;if(n<=0)return;let o=e.getImageData(0,0,t,a),i=o.data;for(let e=0;e<i.length;e+=4)if(Math.random()<n){let t=Math.floor(50*Math.random())-25;i[e]=Math.max(0,Math.min(255,i[e]+t)),i[e+1]=Math.max(0,Math.min(255,i[e+1]+t)),i[e+2]=Math.max(0,Math.min(255,i[e+2]+t))}e.putImageData(o,0,0)}(i,a,l,n),n.blocksEnabled&&function(e,t,a,l){let n=Math.max(5,Math.floor(l.blocksSize)),o=Math.floor(l.blocksOffset*t/100);if(n<=0||o<=0)return;let i=document.createElement("canvas");i.width=t,i.height=a;let r=i.getContext("2d");if(!r)return;r.drawImage(e.canvas,0,0);let s=Math.ceil(t/n),c=Math.ceil(a/n),h=Math.max(1,Math.floor(s*c*Math.max(.01,Math.min(1,l.blocksDensity/100))));for(let l=0;l<h;l++){let l=Math.floor(Math.random()*s)*n,r=Math.floor(Math.random()*c)*n,h=Math.min(n,t-l),d=Math.min(n,a-r),m=Math.floor(Math.random()*o*2)-o,g=Math.floor(Math.random()*o*2)-o;e.drawImage(i,l,r,h,d,l+m,r+g,h,d)}}(i,a,l,n),e.clearRect(0,0,a,l),e.drawImage(o,0,0))}(l,a,R,L,{...JSON.parse(JSON.stringify(t)),masterEnabled:!0});break;case"blur":!function(e,t,a,l){if(l.enabled)switch(l.type){case"gaussian":!function(e,t,a,l){if(l<=0)return;let n=e.getImageData(0,0,t,a),o=n.data,i=new Uint8ClampedArray(o),r=2*Math.ceil(2*l)+1,s=function(e,t){let a=[],l=Math.floor(e/2),n=0;for(let o=0;o<e;o++){let e=o-l,i=Math.exp(-(e*e)/(2*t*t));a[o]=i,n+=i}for(let t=0;t<e;t++)a[t]/=n;return a}(r,l/2),c=Math.floor(r/2);for(let e=0;e<a;e++)for(let a=0;a<t;a++){let l=0,n=0,h=0,d=0,m=0;for(let i=0;i<r;i++){let r=a+i-c;if(r<0||r>=t)continue;let g=(e*t+r)*4,u=s[i];l+=o[g]*u,n+=o[g+1]*u,h+=o[g+2]*u,d+=o[g+3]*u,m+=u}let g=(e*t+a)*4;i[g]=l/m,i[g+1]=n/m,i[g+2]=h/m,i[g+3]=d/m}for(let e=0;e<t;e++)for(let l=0;l<a;l++){let n=0,h=0,d=0,m=0,g=0;for(let o=0;o<r;o++){let r=l+o-c;if(r<0||r>=a)continue;let u=(r*t+e)*4,f=s[o];n+=i[u]*f,h+=i[u+1]*f,d+=i[u+2]*f,m+=i[u+3]*f,g+=f}let u=(l*t+e)*4;o[u]=n/g,o[u+1]=h/g,o[u+2]=d/g,o[u+3]=m/g}e.putImageData(n,0,0)}(e,t,a,l.radius);break;case"radial":!function(e,t,a,l,n,o){if(l<=0)return;let i=e.getImageData(0,0,t,a),r=i.data,s=new Uint8ClampedArray(r),c=n/100*t,h=o/100*a,d=document.createElement("canvas");d.width=t,d.height=a;let m=d.getContext("2d");if(m){m.putImageData(i,0,0);for(let e=0;e<a;e++)for(let n=0;n<t;n++){let o=n-c,i=e-h,d=Math.sqrt(o*o+i*i),m=Math.atan2(i,o),g=0,u=0,f=0,b=0,x=0,p=Math.ceil(2*l);for(let e=0;e<p;e++){let n=e/(p-1),o=d+(n-.5)*l,i=c+o*Math.cos(m),s=h+o*Math.sin(m);if(i<0||i>=t||s<0||s>=a)continue;let v=(Math.floor(s)*t+Math.floor(i))*4,M=1-2*Math.abs(n-.5);g+=r[v]*M,u+=r[v+1]*M,f+=r[v+2]*M,b+=r[v+3]*M,x+=M}let v=(e*t+n)*4;x>0?(s[v]=g/x,s[v+1]=u/x,s[v+2]=f/x,s[v+3]=b/x):(s[v]=r[v],s[v+1]=r[v+1],s[v+2]=r[v+2],s[v+3]=r[v+3])}e.putImageData(new ImageData(s,t,a),0,0)}}(e,t,a,l.radius,l.centerX||50,l.centerY||50);break;case"motion":!function(e,t,a,l,n){if(l<=0)return;let o=e.getImageData(0,0,t,a).data,i=new Uint8ClampedArray(o),r=n*Math.PI/180,s=Math.cos(r),c=Math.sin(r);for(let e=0;e<a;e++)for(let n=0;n<t;n++){let r=0,h=0,d=0,m=0,g=0,u=Math.ceil(2*l);for(let i=0;i<u;i++){let f=i/(u-1),b=(f-.5)*l,x=n+b*s,p=e+b*c;if(x<0||x>=t||p<0||p>=a)continue;let v=(Math.floor(p)*t+Math.floor(x))*4,M=1-2*Math.abs(f-.5);r+=o[v]*M,h+=o[v+1]*M,d+=o[v+2]*M,m+=o[v+3]*M,g+=M}let f=(e*t+n)*4;g>0?(i[f]=r/g,i[f+1]=h/g,i[f+2]=d/g,i[f+3]=m/g):(i[f]=o[f],i[f+1]=o[f+1],i[f+2]=o[f+2],i[f+3]=o[f+3])}e.putImageData(new ImageData(i,t,a),0,0)}(e,t,a,l.radius,l.angle||0);break;case"tiltshift":!function(e,t,a,l,n,o,i,r){if(l<=0)return;let s=e.getImageData(0,0,t,a).data,c=new Uint8ClampedArray(s),h=n/100*t,d=.5*a,m=o/100*Math.max(t,a),g=Math.max(1,i/100*Math.max(t,a)),u=r*Math.PI/180,f=Math.cos(u),b=Math.sin(u);for(let e=0;e<a;e++)for(let n=0;n<t;n++){let o=Math.abs((n-h)*f+(e-d)*b),i=0;o>m/2&&(i=Math.min(1,(o-m/2)/g));let r=Math.floor(l*i);if(r<=0){let a=(e*t+n)*4;c[a]=s[a],c[a+1]=s[a+1],c[a+2]=s[a+2],c[a+3]=s[a+3];continue}let u=0,x=0,p=0,v=0,M=0,j=Math.ceil(2*r);for(let l=0;l<j;l++){let o=l/(j-1),i=(o-.5)*r,c=n+i*b,h=e-i*f;if(c<0||c>=t||h<0||h>=a)continue;let d=(Math.floor(h)*t+Math.floor(c))*4,m=1-2*Math.abs(o-.5);u+=s[d]*m,x+=s[d+1]*m,p+=s[d+2]*m,v+=s[d+3]*m,M+=m}let y=(e*t+n)*4;M>0?(c[y]=u/M,c[y+1]=x/M,c[y+2]=p/M,c[y+3]=v/M):(c[y]=s[y],c[y+1]=s[y+1],c[y+2]=s[y+2],c[y+3]=s[y+3])}e.putImageData(new ImageData(c,t,a),0,0)}(e,t,a,l.radius,l.focusPosition||50,l.focusWidth||25,l.gradient||12.5,l.angle||0)}}(l,R,L,{...JSON.parse(JSON.stringify(t)),enabled:!0});break;case"mosaicShift":!function(e,t,a,l,n){var o;if(!n.enabled)return;let i=document.createElement("canvas");i.width=a,i.height=l;let r=i.getContext("2d");if(!r)return;r.drawImage(t,0,0,a,l),e.clearRect(0,0,a,l),n.useBackgroundColor&&(e.fillStyle=n.backgroundColor||"#000000",e.fillRect(0,0,a,l));let s=Math.ceil(a/n.columns),c=Math.ceil(l/n.rows),h=(o=n.seed,()=>((o=o^o<<13^o>>>17^o<<5)<0?~o+1:o)%1e3/1e3);(function(e,t,a,l){a.forEach(a=>{if(e.save(),0!==a.rotation){let t=a.targetX+a.width/2,l=a.targetY+a.height/2;e.translate(t,l),e.rotate(a.rotation*Math.PI/180),e.translate(-t,-l)}e.drawImage(t,a.sourceX,a.sourceY,a.width,a.height,a.targetX,a.targetY,a.width,a.height),e.restore()})})(e,i,function(e,t,a,l,n,o){let i=[],r=n.intensity/100;for(let s=0;s<n.rows;s++)for(let c=0;c<n.columns;c++){let h=c*a,d=s*l,m=Math.min(a,e-h),g=Math.min(l,t-d);if(m<=0||g<=0)continue;let u=0,f=0,b=0;switch(n.pattern){case"random":u=(2*o()-1)*n.maxOffsetX*r,f=(2*o()-1)*n.maxOffsetY*r;break;case"wave":let x=c/n.columns*Math.PI*4;u=Math.sin(x)*n.maxOffsetX*r,f=Math.cos(x+s/2)*n.maxOffsetY*r;break;case"radial":let p=n.columns/2,v=n.rows/2,M=(c-p)/p,j=(s-v)/v,y=Math.min(1,Math.sqrt(M*M+j*j));u=M*n.maxOffsetX*y*r,f=j*n.maxOffsetY*y*r;break;case"spiral":let w=n.columns/2,C=n.rows/2,k=(c-w)/w,N=(s-C)/C,S=Math.atan2(N,k),I=Math.sqrt(k*k+N*N);u=Math.cos(S+5*I)*I*n.maxOffsetX*r,f=Math.sin(S+5*I)*I*n.maxOffsetY*r}if(n.randomRotation&&(b=(2*o()-1)*n.maxRotation*r),n.preserveEdges){let e=Math.min(1,Math.min(Math.min(c,n.columns-c-1)/(n.columns/4),Math.min(s,n.rows-s-1)/(n.rows/4)));u*=e,f*=e,b*=e}let z=h+u,D=d+f;i.push({sourceX:h,sourceY:d,targetX:z,targetY:D,width:m,height:g,rotation:b})}return i}(a,l,s,c,n,h),0)}(l,a,R,L,{...JSON.parse(JSON.stringify(t)),enabled:!0});break;case"sliceShift":!function(e,t,a,l,n){var o;if(!n.enabled)return;let i=document.createElement("canvas");i.width=a,i.height=l;let r=i.getContext("2d");if(!r)return;r.drawImage(t,0,0,a,l),e.clearRect(0,0,a,l),n.useBackgroundColor&&(e.fillStyle=n.backgroundColor||"#000000",e.fillRect(0,0,a,l));let s=n.intensity/100,c=(o=n.seed,()=>((o=o^o<<13^o>>>17^o<<5)<0?~o+1:o)%1e3/1e3);if(("vertical"===n.direction||"both"===n.direction)&&A(e,i,a,l,n,c,s,"vertical"),"both"===n.direction){let t=document.createElement("canvas");t.width=a,t.height=l;let o=t.getContext("2d");o&&(o.drawImage(e.canvas,0,0),e.clearRect(0,0,a,l),n.useBackgroundColor&&(e.fillStyle=n.backgroundColor||"#000000",e.fillRect(0,0,a,l)),A(e,t,a,l,n,c,s,"horizontal"))}else"horizontal"===n.direction&&A(e,i,a,l,n,c,s,"horizontal")}(l,a,R,L,{...JSON.parse(JSON.stringify(t)),enabled:!0});break;case"posterize":!function(e,t,a,l,n){if(!n.enabled)return;let o=e.getImageData(0,0,a,l),i=o.data,r=256/Math.max(2,Math.min(256,n.levels));for(let e=0;e<i.length;e+=4)if("rgb"===n.colorMode){let t=i[e]+i[e+1]+i[e+2],a=Math.round(t/(3*r))*r/t;i[e]=Math.min(255,Math.round(i[e]*a)),i[e+1]=Math.min(255,Math.round(i[e+1]*a)),i[e+2]=Math.min(255,Math.round(i[e+2]*a))}else if("hsv"===n.colorMode){let t=i[e]/255,a=i[e+1]/255,l=i[e+2]/255,n=Math.max(t,a,l),o=n-Math.min(t,a,l),s=0,c=0===n?0:o/n,h=n;0!==o&&(s=n===t?(a-l)/o%6:n===a?(l-t)/o+2:(t-a)/o+4),(s=Math.round(60*s))<0&&(s+=360),s=Math.round(s/r)*r,c=Math.round(100*c/r)*r/100;let d=(h=Math.round(100*h/r)*r/100)*c,m=d*(1-Math.abs(s/60%2-1)),g=h-d,u=0,f=0,b=0;s>=0&&s<60?(u=d,f=m,b=0):s>=60&&s<120?(u=m,f=d,b=0):s>=120&&s<180?(u=0,f=d,b=m):s>=180&&s<240?(u=0,f=m,b=d):s>=240&&s<300?(u=m,f=0,b=d):(u=d,f=0,b=m),i[e]=Math.round((u+g)*255),i[e+1]=Math.round((f+g)*255),i[e+2]=Math.round((b+g)*255)}else if("lab"===n.colorMode){let t=.299*i[e]+.587*i[e+1]+.114*i[e+2],a=Math.round(t/r)*r;if(n.preserveLuminance){let l=a/t;i[e]=Math.min(255,Math.round(i[e]*l)),i[e+1]=Math.min(255,Math.round(i[e+1]*l)),i[e+2]=Math.min(255,Math.round(i[e+2]*l))}else i[e]=a,i[e+1]=a,i[e+2]=a}if(n.dithering){let e=n.ditherAmount/100;for(let t=0;t<l;t++)for(let n=0;n<a;n++){let o=(t*a+n)*4;if(n<a-1&&t<l-1){let t=(i[o]-Math.round(i[o]/r)*r)*e;i[o+4]+=7*t/16,i[o+4*a]+=5*t/16,i[o+4*a-4]+=3*t/16,i[o+4*a+4]+=1*t/16}}}e.putImageData(o,0,0)}(l,0,R,L,t);break;case"findEdges":!function(e,t,a,l,n){if(!n.enabled)return;let o=document.createElement("canvas");o.width=a,o.height=l;let i=o.getContext("2d");if(!i)return;i.drawImage(t,0,0),n.blurRadius>0&&(i.filter="blur(".concat(n.blurRadius,"px)"),i.drawImage(o,0,0),i.filter="none");let r=i.getImageData(0,0,a,l).data,s=new Uint8ClampedArray(r.length),c=[-1,0,1,-2,0,2,-1,0,1],h=[-1,-2,-1,0,0,0,1,2,1],d=[-1,0,1,-1,0,1,-1,0,1],m=[-1,-1,-1,0,0,0,1,1,1],g=[0,1,0,1,-4,1,0,1,0];for(let e=1;e<l-1;e++)for(let t=1;t<a-1;t++){let l=(e*a+t)*4,o=0,i=0;if("sobel"===n.algorithm||"prewitt"===n.algorithm){let l="sobel"===n.algorithm?c:d,s="sobel"===n.algorithm?h:m;for(let n=-1;n<=1;n++)for(let c=-1;c<=1;c++){let h=((e+n)*a+(t+c))*4,d=(n+1)*3+(c+1),m=.299*r[h]+.587*r[h+1]+.114*r[h+2];o+=m*l[d],i+=m*s[d]}}else if("laplacian"===n.algorithm){for(let l=-1;l<=1;l++)for(let n=-1;n<=1;n++){let i=((e+l)*a+(t+n))*4,s=(l+1)*3+(n+1);o+=(.299*r[i]+.587*r[i+1]+.114*r[i+2])*g[s]}i=o}else if("canny"===n.algorithm)for(let l=-1;l<=1;l++)for(let n=-1;n<=1;n++){let s=((e+l)*a+(t+n))*4,d=(l+1)*3+(n+1),m=.299*r[s]+.587*r[s+1]+.114*r[s+2];o+=m*c[d],i+=m*h[d]}let u=Math.min(255,Math.sqrt(o*o+i*i)*n.intensity/100)>n.threshold?255:0;if("grayscale"===n.colorMode){let e=n.invert?255-u:u;s[l]=e,s[l+1]=e,s[l+2]=e}else"color"===n.colorMode?u>0?(s[l]=r[l],s[l+1]=r[l+1],s[l+2]=r[l+2]):(s[l]=0,s[l+1]=0,s[l+2]=0):u>0?(s[l]=255-r[l],s[l+1]=255-r[l+1],s[l+2]=255-r[l+2]):(s[l]=255,s[l+1]=255,s[l+2]=255);s[l+3]=r[l+3]}let u=new ImageData(s,a,l);e.putImageData(u,0,0)}(l,a,R,L,t)}}),t.drawImage(a,0,0),ef(e.toDataURL()),u(!1)},n.src=s},[s,R,L,ei,es,ej,ew]);(0,n.useEffect)(()=>{s&&eF()},[s,eF]);let eA=(0,n.useCallback)((e,t)=>{let a=new Image;a.onload=()=>{O(a.width),T(a.height),d(e),c(e),eg(!1)},a.src=t},[]),eL=e=>{Z(e.ditherSettings),_(e.halftoneSettings),H(e.colorSettings),el(e.thresholdSettings),ed(e.glitchSettings),et(e.textDitherSettings),eo(e.gradientMapSettings),$(e.gridSettings),ep(e.mosaicShiftSettings),eM(e.sliceShiftSettings||{enabled:!1,slices:40,direction:"vertical",maxOffset:20,mode:"random",intensity:50,seed:1e3*Math.random(),feathering:!1,featherAmount:20,rearrangeMode:"random",backgroundColor:"#000000",useBackgroundColor:!1}),e.instanceSettings&&ec(e.instanceSettings),e.effectInstances&&e.effectInstances.length>0?er(e.effectInstances):er([{id:"color-1",type:"color",enabled:!1},{id:"blur-1",type:"blur",enabled:!1},{id:"gradient-1",type:"gradient",enabled:!1},{id:"threshold-1",type:"threshold",enabled:!1},{id:"dither-1",type:"dither",enabled:!1},{id:"halftone-1",type:"halftone",enabled:!1},{id:"textDither-1",type:"textDither",enabled:!1},{id:"glitch-1",type:"glitch",enabled:!1},{id:"grid-1",type:"grid",enabled:!1},{id:"mosaicShift-1",type:"mosaicShift",enabled:!1},{id:"sliceShift-1",type:"sliceShift",enabled:!1}]),a(e.blur),eF()},eT=()=>{if(!ei||0===ei.length)return!1;let e=(()=>{for(let e=ei.length-1;e>=0;e--){let t=ei[e];if(t.enabled)return t.type}return null})();return"halftone"===e||"dither"===e};return(0,n.useEffect)(()=>{z.current=document.createElement("canvas")},[]),(0,l.jsxs)("div",{className:"flex flex-col lg:flex-row gap-6",children:[(0,l.jsx)("div",{className:"flex-1 min-w-0",children:(0,l.jsxs)("div",{className:"sticky top-20",children:[(0,l.jsx)("div",{className:"flex flex-col gap-3 mb-4",children:(0,l.jsx)("div",{className:"flex w-full justify-between gap-2",children:(0,l.jsxs)("div",{className:"flex flex-nowrap gap-2 items-center",children:[(0,l.jsxs)("label",{className:"px-2 py-1 bg-[var(--header-bg)] text-white text-xs rounded hover:bg-gray-800 transition-colors pp-mondwest-font cursor-pointer flex items-center gap-1 min-w-fit",children:[(0,l.jsx)(E.Yjd,{size:16}),(0,l.jsx)("span",{className:"hidden sm:inline",children:"Upload"}),(0,l.jsx)("input",{type:"file",accept:"image/*",style:{display:"none"},onChange:e=>{e.target.files&&e.target.files[0]&&eN([e.target.files[0]])}})]}),(0,l.jsxs)("button",{onClick:eD,className:"px-2 py-1 bg-[var(--header-bg)] text-white text-xs rounded hover:bg-gray-800 transition-colors pp-mondwest-font flex items-center gap-1 min-w-fit",children:[(0,l.jsx)(E.M67,{size:16}),(0,l.jsx)("span",{className:"hidden sm:inline",children:"Random"})]}),(0,l.jsxs)("button",{onClick:()=>{c(null),d(null)},className:"px-2 py-1 bg-[var(--header-bg)] text-white text-xs rounded hover:bg-gray-800 transition-colors pp-mondwest-font flex items-center gap-1 min-w-fit",children:[(0,l.jsx)(E.We9,{size:16}),(0,l.jsx)("span",{className:"hidden sm:inline",children:"Clear"})]}),(0,l.jsx)("div",{className:"h-4 mx-1 border-r border-[var(--border-color)]"}),(0,l.jsxs)("button",{onClick:eE,disabled:!h,className:"px-2 py-1 ".concat(h?"bg-[var(--header-bg)] text-white hover:bg-gray-800":"bg-gray-800 text-gray-500 cursor-not-allowed"," text-xs rounded transition-colors pp-mondwest-font flex items-center gap-1 min-w-fit"),children:[(0,l.jsx)(E.Bw1,{size:16}),(0,l.jsx)("span",{className:"hidden sm:inline",children:"Reset"})]}),(0,l.jsx)("div",{className:"h-4 mx-1 border-r border-[var(--border-color)]"}),(0,l.jsxs)("label",{className:"px-2 py-1 bg-[var(--header-bg)] text-white text-xs rounded hover:bg-gray-800 transition-colors pp-mondwest-font cursor-pointer flex items-center gap-1 min-w-fit",children:[(0,l.jsx)(E._hL,{size:16}),(0,l.jsx)("span",{className:"hidden sm:inline",children:"Save"}),(0,l.jsx)("input",{type:"file",style:{display:"none"},ref:eb,onClick:e=>{e.preventDefault(),D({ditherSettings:Q,halftoneSettings:W,colorSettings:V,thresholdSettings:ea,glitchSettings:eh,textDitherSettings:ee,gradientMapSettings:en,gridSettings:K,effectInstances:ei,blur:t,mosaicShiftSettings:ex,sliceShiftSettings:ev,posterizeSettings:ej,findEdgesSettings:ew,instanceSettings:es})}})]}),(0,l.jsxs)("label",{className:"px-2 py-1 bg-[var(--header-bg)] text-white text-xs rounded hover:bg-gray-800 transition-colors pp-mondwest-font cursor-pointer flex items-center gap-1 min-w-fit",children:[(0,l.jsx)(E.Yjd,{size:16}),(0,l.jsx)("span",{className:"hidden sm:inline",children:"Load"}),(0,l.jsx)("input",{type:"file",accept:".json",style:{display:"none"},onChange:ek})]}),(0,l.jsx)("div",{className:"h-4 mx-1 border-r border-[var(--border-color)]"}),(0,l.jsxs)("button",{className:"px-2 py-1 bg-[var(--header-bg)] text-white text-xs rounded hover:bg-gray-800 transition-colors pp-mondwest-font flex items-center gap-1 min-w-fit",onClick:()=>m.current&&j(m.current),disabled:!s,title:"Export as PNG",children:[(0,l.jsx)(E.LFN,{size:16}),(0,l.jsx)("span",{className:"hidden sm:inline",children:"PNG"})]}),(0,l.jsxs)("button",{className:"px-2 py-1 rounded-md flex items-center space-x-1 text-xs transition-colors pp-mondwest-font ".concat(eT()?"bg-[var(--header-bg)] text-white hover:bg-gray-800":"bg-gray-800 border-gray-900 text-gray-500 cursor-not-allowed"),onClick:()=>m.current&&eT()&&y(m.current),disabled:!s||!eT(),title:eT()?"Export as true vector SVG (halftone/dither)":"Vector SVG export only available when halftone or dither is the last effect",children:[(0,l.jsx)(E.NOg,{size:16}),(0,l.jsx)("span",{className:"hidden sm:inline",children:"SVG"})]})]})})}),(0,l.jsx)("div",{className:"relative",children:(0,l.jsxs)("div",{...eS(),className:"border-2 border-dashed ".concat(ez?"border-blue-500 bg-blue-50 dark:bg-blue-900/10":"border-[var(--border-color)]"," rounded-lg p-4 text-center cursor-pointer transition-colors bg-[var(--secondary-bg)]"),children:[(0,l.jsx)("input",{...eI()}),s?(0,l.jsx)("canvas",{ref:m,width:R,height:L,className:"max-w-full h-auto mx-auto"}):(0,l.jsx)("div",{className:"py-12",children:(0,l.jsx)("p",{className:"text-[var(--text-secondary)] pp-mondwest-font",children:f?"Loading random image...":"Drag & drop an image here, or click to select"})})]})})]})}),(0,l.jsx)("div",{className:"lg:w-1/3 xl:w-[35%]",children:(0,l.jsx)("div",{className:"sticky top-20 bg-[var(--accent-bg)] p-4 rounded-lg border border-[var(--border-color)] shadow-sm",children:(0,l.jsx)(F,{ditherSettings:Q,halftoneSettings:W,colorSettings:V,thresholdSettings:ea,glitchSettings:eh,textDitherSettings:ee,gradientMapSettings:en,gridSettings:K,effectInstances:ei,instanceSettings:es,updateDitherSettings:e=>Z(t=>({...t,...e})),updateHalftoneSettings:(e,t)=>{"colored"===e?!1===t?_(e=>({...e,colored:!1,channels:{cyan:!1,magenta:!1,yellow:!1,black:!0}})):_(e=>({...e,colored:!0,channels:{cyan:!0,magenta:!0,yellow:!0,black:!0}})):_(a=>({...a,[e]:t}))},updateColorSettings:(e,t)=>{H(a=>({...a,[e]:t}))},updateThresholdSettings:e=>el(t=>({...t,...e})),updateGlitchSettings:e=>ed(t=>({...t,...e})),updateTextDitherSettings:e=>et(t=>({...t,...e})),updateGradientMapSettings:e=>eo(t=>({...t,...e})),updateGridSettings:(e,t)=>{$(a=>({...a,[e]:t}))},updateInstanceSettings:(e,t)=>{ec(a=>({...a,[e]:{...a[e],...t}}))},updateEffectInstances:e=>{er(e)},addEffect:e=>{let a=eR(e),l={id:a,type:e,enabled:!1},n={};switch(e){case"dither":n={enabled:!0,type:"floyd-steinberg",threshold:128,colorMode:"grayscale",resolution:30,colorDepth:2,darkColor:"#000000",lightColor:"#FFFFFF"};break;case"color":n={enabled:!0,hueShift:0,saturation:100,brightness:100,contrast:100,posterize:0,invert:!1,glitchIntensity:0,glitchSeed:Math.random(),blendMode:"normal"};break;case"halftone":n={...W,enabled:!0};break;case"gradient":n={...en,enabled:!0};break;case"threshold":n={...ea,enabled:!0};break;case"textDither":n={...ee,enabled:!0};break;case"grid":n={...K,enabled:!0};break;case"glitch":n={...eh,enabled:!0};break;case"blur":n={...t,enabled:!0};break;case"mosaicShift":n={...ex,enabled:!0,seed:1e3*Math.random()};break;case"sliceShift":n={...ev,enabled:!0,seed:1e3*Math.random()};break;case"posterize":n={...ej,enabled:!0};break;case"findEdges":n={...ew,enabled:!0}}er(e=>[...e,l]),ec(e=>({...e,[a]:n}))},duplicateEffect:e=>{let t=ei.find(t=>t.id===e);if(t){let e=ei.filter(e=>e.type===t.type).length,a="".concat(t.type,"-").concat(e+1),l={...t,id:a};if(es[t.id]){let e=JSON.parse(JSON.stringify(es[t.id]));ec(t=>({...t,[a]:e}))}er(e=>[...e,l])}},removeEffect:e=>{er(t=>t.filter(t=>t.id!==e)),ec(t=>{let a={...t};return delete a[e],a})},onResetImage:eE,onExportPng:()=>m.current&&j(m.current),onExportSvg:()=>m.current&&y(m.current),onCropImage:()=>eg(!0),blur:t,onBlurChange:e=>a(e),onSettingsLoaded:eL,mosaicShiftSettings:ex,updateMosaicShiftSettings:e=>ep(t=>({...t,...e})),sliceShiftSettings:ev,updateSliceShiftSettings:e=>eM(t=>({...t,...e})),posterizeSettings:ej,updatePosterizeSettings:e=>ey(t=>({...t,...e})),findEdgesSettings:ew,updateFindEdgesSettings:e=>eC(t=>({...t,...e}))})})}),em&&h&&m.current&&(0,l.jsx)(k,{imageUrl:h,modifiedImageUrl:m.current.toDataURL(),onCropComplete:eA,onCancel:()=>eg(!1)})]})}},9514:function(){}}]);